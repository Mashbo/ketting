!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t,n){e.exports=n(3)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(25)),i=r(n(16)),a=r(n(11)),c=o(n(66)),u=o(n(29));n(12);const h=n(67),l=n(10);t.default=class{constructor(e,t){void 0===t&&(t={}),this.resourceCache={},this.contentTypes=[{mime:"application/hal+json",representor:"hal",q:"1.0"},{mime:"application/json",representor:"hal",q:"0.9"},{mime:"text/html",representor:"html",q:"0.8"}],t.auth&&(this.auth=t.auth,"oauth2"===t.auth.type&&(this.oauth2Helper=new h.OAuth2Helper(t.auth))),t.fetchInit&&(this.fetchInit=t.fetchInit),this.bookMark=e}follow(e,t){return this.getResource().follow(e,t)}getResource(e,t){return void 0===e&&(e=""),void 0===(e=l.resolve(this.bookMark,e))&&(t=!1),this.resourceCache[e]&&!t||(this.resourceCache[e]=new a.default(this,e)),this.resourceCache[e]}fetch(e,t){const r=u.createFetchRequest(e,t,this.fetchInit);if(r.headers.has("User-Agent")||r.headers.set("User-Agent","Ketting/"+n(75).version),!r.headers.has("Authorization")&&this.auth)switch(this.auth.type){case"basic":r.headers.set("Authorization","Basic "+c.encode(this.auth.userName+":"+this.auth.password));break;case"bearer":r.headers.set("Authorization","Bearer "+this.auth.token);break;case"oauth2":return this.oauth2Helper.fetch(r)}return fetch(r)}getRepresentor(e){-1!==e.indexOf(";")&&(e=e.split(";")[0]),e=e.trim();const t=this.contentTypes.find(t=>t.mime===e);if(!t)throw new Error("Could not find a representor for contentType: "+e);switch(t.representor){case"html":return i.default;case"hal":return s.default;default:throw new Error("Unknown representor: "+t.representor)}}getAcceptHeader(){return this.contentTypes.map(e=>{let t=e.mime;return e.q&&(t+=";q="+e.q),t}).join(", ")}}},function(e,t){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));if(3!==arguments.length)return r[t];r[t]=n}},function(e,t,n){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=[];
/*!
 * Chai version
 */t.version="4.2.0",
/*!
 * Assertion Error
 */
t.AssertionError=n(18);
/*!
 * Utils for plugins (not exported)
 */
var o=n(34);t.use=function(e){return~r.indexOf(e)||(e(t,o),r.push(e)),t},
/*!
 * Utility Functions
 */
t.util=o;
/*!
 * Configuration
 */
var s=n(5);t.config=s;
/*!
 * Primary `Assertion` prototype
 */
var i=n(51);t.use(i);
/*!
 * Core Assertions
 */
var a=n(52);t.use(a);
/*!
 * Expect interface
 */
var c=n(53);t.use(c);
/*!
 * Should interface
 */
var u=n(54);t.use(u);
/*!
 * Assert interface
 */
var h=n(55);t.use(h)},function(e,t){
/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));for(var o in t.__flags||(t.__flags=Object.create(null)),n=3!==arguments.length||n,r)(n||"object"!==o&&"ssfi"!==o&&"lockSsfi"!==o&&"message"!=o)&&(t.__flags[o]=r[o])}},function(e,t){e.exports={includeStack:!1,showDiff:!0,truncateThreshold:40,useProxy:!0,proxyExcludedKeys:["then","catch","inspect","toJSON"]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(57)),s=n(10);t.default=class{constructor(e){this.templated=!1,this.title=null,this.type=null;for(const t of["baseHref","href","name","rel","templated","title","type"])e[t]&&(this[t]=e[t])}resolve(){return s.resolve(this.baseHref,this.href)}expand(e){if(this.templated){const t=o.default.parse(this.href).expand(e);return s.resolve(this.baseHref,t)}return s.resolve(this.baseHref,this.href)}}},function(e,t,n){var r=n(5);
/*!
 * Chai - isProxyEnabled helper
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(){return r.useProxy&&"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect}},function(e,t){var n=Object.getOwnPropertyDescriptor(function(){},"length");
/*!
 * Chai - addLengthGuard utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(e,t,r){return n.configurable?(Object.defineProperty(e,"length",{get:function(){if(r)throw Error("Invalid Chai property: "+t+'.length. Due to a compatibility issue, "length" cannot directly follow "'+t+'". Use "'+t+'.lengthOf" instead.');throw Error("Invalid Chai property: "+t+'.length. See docs for proper usage of "'+t+'".')}}),e):e}},function(e,t,n){var r=n(5),o=n(2),s=n(22),i=n(7),a=["__flags","__methods","_obj","assert"];e.exports=function(e,t){return i()?new Proxy(e,{get:function e(n,i){if("string"==typeof i&&-1===r.proxyExcludedKeys.indexOf(i)&&!Reflect.has(n,i)){if(t)throw Error("Invalid Chai property: "+t+"."+i+'. See docs for proper usage of "'+t+'".');var c=null,u=4;throw s(n).forEach(function(e){if(!Object.prototype.hasOwnProperty(e)&&-1===a.indexOf(e)){var t=function(e,t,n){if(Math.abs(e.length-t.length)>=n)return n;for(var r=[],o=0;o<=e.length;o++)r[o]=Array(t.length+1).fill(0),r[o][0]=o;for(var s=0;s<t.length;s++)r[0][s]=s;for(var o=1;o<=e.length;o++)for(var i=e.charCodeAt(o-1),s=1;s<=t.length;s++)Math.abs(o-s)>=n?r[o][s]=n:r[o][s]=Math.min(r[o-1][s]+1,r[o][s-1]+1,r[o-1][s-1]+(i===t.charCodeAt(s-1)?0:1));return r[e.length][t.length]}(i,e,u);t<u&&(c=e,u=t)}}),null!==c?Error("Invalid Chai property: "+i+'. Did you mean "'+c+'"?'):Error("Invalid Chai property: "+i)}return-1!==a.indexOf(i)||o(n,"lockSsfi")||o(n,"ssfi",e),Reflect.get(n,i)}}):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=function(e,t){if("undefined"!=typeof URL)return new URL(t,e).toString();const n=document,r=n.getElementsByTagName("base")[0],o=r&&r.href,s=n.head||n.getElementsByTagName("head")[0],i=r||s.appendChild(n.createElement("base")),a=n.createElement("a");i.href=e,a.href=t;const c=a.href;return r?r.href=o:s.removeChild(i),c}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),s=r(n(24)),i=r(n(28)),a=r(n(6)),c=n(29),u=n(10);t.default=class{constructor(e,t,n=null){this.inFlightRefresh=null,this.client=e,this.uri=t,this.repr=null,this.contentType=n}async get(){return(await this.representation()).body}async put(e){const t=this.contentType||this.client.contentTypes[0].mime,n={method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":t,Accept:this.contentType?this.contentType:this.client.getAcceptHeader()}};await this.fetchAndThrow(n),this.repr=null}async delete(){await this.fetchAndThrow({method:"DELETE"}),this.repr=null}async post(e){const t=this.contentType||this.client.contentTypes[0].mime,n=await this.fetchAndThrow({method:"POST",body:JSON.stringify(e),headers:{"Content-Type":t}});return n.headers.has("location")?this.client.getResource(u.resolve(this.uri,n.headers.get("location"))):null}async patch(e){await this.fetchAndThrow({method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),this.repr=null}async refresh(){let e,t;this.inFlightRefresh?[e,t]=await this.inFlightRefresh:(this.inFlightRefresh=this.fetchAndThrow({method:"GET",headers:{Accept:this.contentType?this.contentType:this.client.getAcceptHeader()}}).then(t=>(e=t).text()).then(n=>[e,t=n]),await this.inFlightRefresh,this.inFlightRefresh=null);const n=e.headers.get("Content-Type");if(!n)throw new Error("Server did not respond with a Content-Type header");this.repr=new(this.client.getRepresentor(n))(this.uri,n,t),this.contentType||(this.contentType=n);const r=e.headers.get("Link");if(r)for(const e of o.default.parse(r).refs)for(const t of e.rel.split(" "))this.repr.links.push(new a.default({rel:t,baseHref:this.uri,href:e.uri}));for(const e of Object.keys(this.repr.embedded))this.client.getResource(e).repr=new(this.client.getRepresentor(n))(e,n,this.repr.embedded[e]);return this.repr.body}async links(e){const t=await this.representation();return e?t.links.filter(t=>t.rel===e):t.links}follow(e,t){return new s.default(async(n,r)=>{try{const o=await this.links(e);let s;if(0===o.length)throw new Error("Relation with type "+e+" not found on resource "+this.uri);s=o[0].templated&&t?o[0].expand(t):o[0].resolve();const i=this.client.getResource(s);o[0].type&&(i.contentType=o[0].type),n(i)}catch(e){r(e)}})}async followAll(e){return(await this.links(e)).map(e=>{const t=this.client.getResource(e.resolve());return e.type&&(t.contentType=e.type),t})}async representation(){return this.repr||await this.refresh(),this.repr}fetch(e,t){let n=null,r={};if(void 0===e)n=this.uri;else if("string"==typeof e)n=u.resolve(this.uri,e);else if(e instanceof Request)n=u.resolve(this.uri,e.url),r.method=e.method,r.headers=new Headers(e.headers),r.body=e.body,r.mode=e.mode,r.credentials=e.credentials,r.cache=e.cache,r.redirect=e.redirect,r.referrer=e.referrer,r.integrity=e.integrity;else{if(!(e instanceof Object))throw new TypeError("When specified, input must be a string, Request object or a key-value object");n=this.uri,r=e}if(t){for(const e of Object.keys(t))"headers"!==e&&(r[e]=t[e]);r.headers=c.mergeHeaders([r.headers,t.headers])}const o=new Request(n,r);return this.client.fetch(o)}async fetchAndThrow(e,t){const n=await this.fetch(e,t);if(n.ok)return n;throw await i.default(n)}}},function(e,t,n){"use strict"},function(e,t,n){(function(t){!function(t,n){e.exports=n()}(0,function(){"use strict";var e="function"==typeof Promise,n="object"==typeof self?self:t,r="undefined"!=typeof Symbol,o="undefined"!=typeof Map,s="undefined"!=typeof Set,i="undefined"!=typeof WeakMap,a="undefined"!=typeof WeakSet,c="undefined"!=typeof DataView,u=r&&void 0!==Symbol.iterator,h=r&&void 0!==Symbol.toStringTag,l=s&&"function"==typeof Set.prototype.entries,f=o&&"function"==typeof Map.prototype.entries,p=l&&Object.getPrototypeOf((new Set).entries()),d=f&&Object.getPrototypeOf((new Map).entries()),y=u&&"function"==typeof Array.prototype[Symbol.iterator],w=y&&Object.getPrototypeOf([][Symbol.iterator]()),g=u&&"function"==typeof String.prototype[Symbol.iterator],b=g&&Object.getPrototypeOf(""[Symbol.iterator]()),m=8,v=-1;return function(t){var r=typeof t;if("object"!==r)return r;if(null===t)return"null";if(t===n)return"global";if(Array.isArray(t)&&(!1===h||!(Symbol.toStringTag in t)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&t===window.location)return"Location";if("object"==typeof window.document&&t===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&t===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&t===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&t instanceof window.HTMLElement){if("BLOCKQUOTE"===t.tagName)return"HTMLQuoteElement";if("TD"===t.tagName)return"HTMLTableDataCellElement";if("TH"===t.tagName)return"HTMLTableHeaderCellElement"}}var u=h&&t[Symbol.toStringTag];if("string"==typeof u)return u;var l=Object.getPrototypeOf(t);return l===RegExp.prototype?"RegExp":l===Date.prototype?"Date":e&&l===Promise.prototype?"Promise":s&&l===Set.prototype?"Set":o&&l===Map.prototype?"Map":a&&l===WeakSet.prototype?"WeakSet":i&&l===WeakMap.prototype?"WeakMap":c&&l===DataView.prototype?"DataView":o&&l===d?"Map Iterator":s&&l===p?"Set Iterator":y&&l===w?"Array Iterator":g&&l===b?"String Iterator":null===l?"Object":Object.prototype.toString.call(t).slice(m,v)}})}).call(this,n(14))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(21),o=n(22),s=n(39),i=n(5);e.exports=function(e,t,n,r){return c({showHidden:t,seen:[],stylize:function(e){return e}},e,void 0===n?2:n)};var a=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&"nodeType"in e&&1===e.nodeType&&"string"==typeof e.nodeName};function c(e,n,y){if(n&&"function"==typeof n.inspect&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var w=n.inspect(y,e);return"string"!=typeof w&&(w=c(e,w,y)),w}var g=function(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string");case"number":return 0===t&&1/t==-1/0?e.stylize("-0","number"):e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean");case"symbol":return e.stylize(t.toString(),"symbol")}if(null===t)return e.stylize("null","null")}(e,n);if(g)return g;if(a(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion)return(new XMLSerializer).serializeToString(n);var b=document.createElementNS("http://www.w3.org/1999/xhtml","_");b.appendChild(n.cloneNode(!1));var m=b.innerHTML.replace("><",">"+n.innerHTML+"<");return b.innerHTML="",m}catch(e){}}var v,x,j=s(n),_=e.showHidden?o(n):j;if(0===_.length||p(n)&&(1===_.length&&"stack"===_[0]||2===_.length&&"description"===_[0]&&"stack"===_[1])){if("function"==typeof n)return x=(v=r(n))?": "+v:"",e.stylize("[Function"+x+"]","special");if(l(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(f(n))return e.stylize(Date.prototype.toUTCString.call(n),"date");if(p(n))return u(n)}var k,O="",A=!1,T=!1,E=["{","}"];if(function(e){return"object"==typeof e&&/\w+Array]$/.test(d(e))}(n)&&(T=!0,E=["[","]"]),function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===d(e)}(n)&&(A=!0,E=["[","]"]),"function"==typeof n&&(O=" [Function"+(x=(v=r(n))?": "+v:"")+"]"),l(n)&&(O=" "+RegExp.prototype.toString.call(n)),f(n)&&(O=" "+Date.prototype.toUTCString.call(n)),p(n))return u(n);if(0===_.length&&(!A||0==n.length))return E[0]+O+E[1];if(y<0)return l(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");if(e.seen.push(n),A)k=function(e,t,n,r,o){for(var s=[],i=0,a=t.length;i<a;++i)Object.prototype.hasOwnProperty.call(t,String(i))?s.push(h(e,t,n,r,String(i),!0)):s.push("");return o.forEach(function(o){o.match(/^\d+$/)||s.push(h(e,t,n,r,o,!0))}),s}(e,n,y,j,_);else{if(T)return function(e){for(var t="[ ",n=0;n<e.length;++n){if(t.length>=i.truncateThreshold-7){t+="...";break}t+=e[n]+", "}-1!==(t+=" ]").indexOf(",  ]")&&(t=t.replace(",  ]"," ]"));return t}(n);k=_.map(function(t){return h(e,n,y,j,t,A)})}return e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return e+t.length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(k,O,E)}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,o,s){var i,a,u=Object.getOwnPropertyDescriptor(t,o);if(u&&(u.get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special"))),r.indexOf(o)<0&&(i="["+o+"]"),a||(e.seen.indexOf(t[o])<0?(a=c(e,t[o],null===n?null:n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),void 0===i){if(s&&o.match(/^\d+$/))return a;(i=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+a}function l(e){return"object"==typeof e&&"[object RegExp]"===d(e)}function f(e){return"object"==typeof e&&"[object Date]"===d(e)}function p(e){return"object"==typeof e&&"[object Error]"===d(e)}function d(e){return Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(6)),s=r(n(26));function i(e,t){for(const n of t){const t=n.getAttribute("rel"),r=n.getAttribute("href"),s=n.getAttribute("type")||void 0;if(t&&r)for(const n of t.split(" ")){const t=new o.default({rel:n,baseHref:e.uri,href:r,type:s});e.links.push(t)}}}t.default=class extends s.default{constructor(e,t,n){super(e,t,n);const r=(new DOMParser).parseFromString(n,"text/html");i(this,r.getElementsByTagName("link")),i(this,r.getElementsByTagName("a"))}}},function(e,t,n){"use strict";var r=t,o=n(27).Buffer;function s(e,t){try{return decodeURIComponent(e)}catch(n){return r.unescapeBuffer(e,t).toString()}}r.unescapeBuffer=function(e,t){for(var n,r,s,i=new o(e.length),a=0,c=0,u=0;c<=e.length;c++){var h=c<e.length?e.charCodeAt(c):NaN;switch(a){case 0:switch(h){case 37:n=0,r=0,a=1;break;case 43:t&&(h=32);default:i[u++]=h}break;case 1:if(s=h,h>=48&&h<=57)n=h-48;else if(h>=65&&h<=70)n=h-65+10;else{if(!(h>=97&&h<=102)){i[u++]=37,i[u++]=h,a=0;break}n=h-97+10}a=2;break;case 2:if(a=0,h>=48&&h<=57)r=h-48;else if(h>=65&&h<=70)r=h-65+10;else{if(!(h>=97&&h<=102)){i[u++]=37,i[u++]=s,i[u++]=h;break}r=h-97+10}i[u++]=16*n+r}}return i.slice(0,u-1)},r.unescape=s;for(var i=new Array(256),a=0;a<256;++a)i[a]="%"+((a<16?"0":"")+a.toString(16)).toUpperCase();r.escape=function(e){"string"!=typeof e&&(e+="");for(var t="",n=0,r=0;r<e.length;++r){var o=e.charCodeAt(r);if(!(33===o||45===o||46===o||95===o||126===o||o>=39&&o<=42||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122))if(r-n>0&&(t+=e.slice(n,r)),o<128)n=r+1,t+=i[o];else if(o<2048)n=r+1,t+=i[192|o>>6]+i[128|63&o];else if(o<55296||o>=57344)n=r+1,t+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o];else{var s;if(!(++r<e.length))throw new URIError("URI malformed");s=1023&e.charCodeAt(r),n=r+1,t+=i[240|(o=65536+((1023&o)<<10|s))>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o]}}return 0===n?e:n<e.length?t+e.slice(n):t};var c=function(e){return"string"==typeof e?e:"number"==typeof e&&isFinite(e)?""+e:"boolean"==typeof e?e?"true":"false":""};function u(e,t){try{return t(e)}catch(t){return r.unescape(e,!0)}}r.stringify=r.encode=function(e,t,n,o){t=t||"&",n=n||"=";var s=r.escape;if(o&&"function"==typeof o.encodeURIComponent&&(s=o.encodeURIComponent),null!==e&&"object"==typeof e){for(var i=Object.keys(e),a=i.length,u=a-1,h="",l=0;l<a;++l){var f=i[l],p=e[f],d=s(c(f))+n;if(Array.isArray(p)){for(var y=p.length,w=y-1,g=0;g<y;++g)h+=d+s(c(p[g])),g<w&&(h+=t);y&&l<u&&(h+=t)}else h+=d+s(c(p)),l<u&&(h+=t)}return h}return""},r.parse=r.decode=function(e,t,n,o){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;"string"!=typeof t&&(t+="");var a=n.length,c=t.length,h=1e3;o&&"number"==typeof o.maxKeys&&(h=o.maxKeys);var l=1/0;h>0&&(l=h);var f=r.unescape;o&&"function"==typeof o.decodeURIComponent&&(f=o.decodeURIComponent);for(var p=f!==s,d=[],y=0,w=0,g=0,b="",m="",v=p,x=p,j=0,_=0;_<e.length;++_){var k=e.charCodeAt(_);if(k!==t.charCodeAt(w)){if(w=0,x||(37===k?j=1:j>0&&(k>=48&&k<=57||k>=65&&k<=70||k>=97&&k<=102)?3==++j&&(x=!0):j=0),g<a){if(k===n.charCodeAt(g)){if(++g===a)y<(A=_-g+1)&&(b+=e.slice(y,A)),j=0,y=_+1;continue}g=0,v||(37===k?j=1:j>0&&(k>=48&&k<=57||k>=65&&k<=70||k>=97&&k<=102)?3==++j&&(v=!0):j=0)}43===k&&(g<a?(_-y>0&&(b+=e.slice(y,_)),b+="%20",v=!0):(_-y>0&&(m+=e.slice(y,_)),m+="%20",x=!0),y=_+1)}else if(++w===c){var O,A=_-w+1;if(g<a?y<A&&(b+=e.slice(y,A)):y<A&&(m+=e.slice(y,A)),v&&(b=u(b,f)),x&&(m=u(m,f)),-1===d.indexOf(b))i[b]=m,d[d.length]=b;else(O=i[b])instanceof Array?O[O.length]=m:i[b]=[O,m];if(0==--l)break;v=x=p,j=0,b=m="",y=_+1,w=g=0}}l>0&&(y<e.length||g>0)&&(y<e.length&&(g<a?b+=e.slice(y):w<c&&(m+=e.slice(y))),v&&(b=u(b,f)),x&&(m=u(m,f)),-1===d.indexOf(b)?(i[b]=m,d[d.length]=b):(O=i[b])instanceof Array?O[O.length]=m:i[b]=[O,m]);return i}},function(e,t){
/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */
/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */
function n(){var e=[].slice.call(arguments);function t(t,n){Object.keys(n).forEach(function(r){~e.indexOf(r)||(t[r]=n[r])})}return function(){for(var e=[].slice.call(arguments),n=0,r={};n<e.length;n++)t(r,e[n]);return r}}function r(e,t,o){var s=n("name","message","stack","constructor","toJSON")(t||{});for(var i in this.message=e||"Unspecified AssertionError",this.showDiff=!1,s)this[i]=s[i];if(o=o||r,Error.captureStackTrace)Error.captureStackTrace(this,o);else try{throw new Error}catch(e){this.stack=e.stack}}
/*!
 * Inherit from Error.prototype
 */
/*!
 * Primary Exports
 */
e.exports=r,r.prototype=Object.create(Error.prototype),
/*!
 * Statically set name
 */
r.prototype.name="AssertionError",
/*!
 * Ensure correct constructor
 */
r.prototype.constructor=r,r.prototype.toJSON=function(e){var t=n("constructor","toJSON","stack")({name:this.name},this);return!1!==e&&this.stack&&(t.stack=this.stack),t}},function(e,t){
/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){return t.length>4?t[4]:e._obj}},function(e,t,n){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(15),o=n(5);e.exports=function(e){var t=r(e),n=Object.prototype.toString.call(e);if(o.truncateThreshold&&t.length>=o.truncateThreshold){if("[object Function]"===n)return e.name&&""!==e.name?"[Function: "+e.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+e.length+") ]";if("[object Object]"===n){var s=Object.keys(e);return"{ Object ("+(s.length>2?s.splice(0,2).join(", ")+", ...":s.join(", "))+") }"}return t}return t}},function(e,t,n){"use strict";var r=Function.prototype.toString,o=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\s\(\/]+)/;e.exports=function(e){if("function"!=typeof e)return null;var t="";if(void 0===Function.prototype.name&&void 0===e.name){var n=r.call(e).match(o);n&&(t=n[1])}else t=e.name;return t}},function(e,t){
/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=Object.getOwnPropertyNames(e);function n(e){-1===t.indexOf(e)&&t.push(e)}for(var r=Object.getPrototypeOf(e);null!==r;)Object.getOwnPropertyNames(r).forEach(n),r=Object.getPrototypeOf(r);return t}},function(e,t){
/*!
 * Chai - getOwnEnumerablePropertySymbols utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){return"function"!=typeof Object.getOwnPropertySymbols?[]:Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.realPromise=new Promise(e)}then(e,t){return this.realPromise.then(e,t)}catch(e){return this.realPromise.catch(e)}follow(e,t){return new r((n,r)=>{this.realPromise.then(r=>{n(r.follow(e,t))}).catch(e=>{r(e)})})}followAll(e){return this.realPromise.then(t=>t.followAll(e))}}t.default=r},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(6)),s=n(10),i=r(n(26));t.default=class extends i.default{constructor(e,t,n){super(e,t,n),this.body="string"==typeof n?JSON.parse(n):n,void 0!==this.body._links&&a(this),void 0!==this.body._embedded&&u(this),delete this.body._links,delete this.body._embedded}};const a=e=>{for(const t of Object.keys(e.body._links)){let n=e.body._links[t];Array.isArray(n)||(n=[n]),c(e,t,n)}},c=(e,t,n)=>{for(const r of n)e.links.push(new o.default({rel:t,baseHref:e.uri,href:r.href,title:r.title,type:r.type,templated:r.templated,name:r.name}))},u=e=>{for(const t of Object.keys(e.body._embedded)){let n=e.body._embedded[t];Array.isArray(n)||(n=[n]);for(const r of n){const n=s.resolve(e.uri,r._links.self.href);e.links.find(e=>e.rel===t&&r._links.self.href===e.href)||e.links.push(new o.default({rel:t,baseHref:e.uri,href:r._links.self.href})),e.embedded[n]=r}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n){this.uri=e,this.contentType=t,this.body=n,this.links=[],this.embedded={}}}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(62),o=n(63),s=n(64);function i(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):f(e,t);if("Buffer"===t.type&&s(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(h(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return z(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function w(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,o){var s,i=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,a/=2,c/=2,n/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o){var h=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===c)return h*i}else-1!==h&&(s-=s-h),h=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var l=!0,f=0;f<c;f++)if(u(e,s+f)!==u(t,f)){l=!1;break}if(l)return s}return-1}function b(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var i=0;i<r;++i){var a=parseInt(t.substr(2*i,2),16);if(isNaN(a))return i;e[n+i]=a}return i}function m(e,t,n,r){return L(z(t,e.length-n),e,n,r)}function v(e,t,n,r){return L(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function x(e,t,n,r){return v(e,t,n,r)}function j(e,t,n,r){return L(H(t),e,n,r)}function _(e,t,n,r){return L(function(e,t){for(var n,r,o,s=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,o=n%256,s.push(o),s.push(r);return s}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var s,i,a,c,u=e[o],h=null,l=u>239?4:u>223?3:u>191?2:1;if(o+l<=n)switch(l){case 1:u<128&&(h=u);break;case 2:128==(192&(s=e[o+1]))&&(c=(31&u)<<6|63&s)>127&&(h=c);break;case 3:s=e[o+1],i=e[o+2],128==(192&s)&&128==(192&i)&&(c=(15&u)<<12|(63&s)<<6|63&i)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:s=e[o+1],i=e[o+2],a=e[o+3],128==(192&s)&&128==(192&i)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&i)<<6|63&a)>65535&&c<1114112&&(h=c)}null===h?(h=65533,l=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),o+=l}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=i(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return h(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,s=Math.min(n,r);o<s;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!c.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var s=o-r,i=n-t,a=Math.min(s,i),u=this.slice(r,o),h=e.slice(t,n),l=0;l<a;++l)if(u[l]!==h[l]){s=u[l],i=h[l];break}return s<i?-1:i<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return w(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return w(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return m(this,e,t,n);case"ascii":return v(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return j(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",s=t;s<n;++s)o+=B(e[s]);return o}function S(e,t,n){for(var r=e.slice(t,n),o="",s=0;s<r.length;s+=2)o+=String.fromCharCode(r[s]+256*r[s+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function q(e,t,n,r,o,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function C(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,s=Math.min(e.length-n,2);o<s;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function N(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,s=Math.min(e.length-n,4);o<s;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function R(e,t,n,r,o,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,s){return s||R(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,s){return s||R(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var s=0;s<o;++s)n[s]=this[s+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,s=0;++s<t&&(o*=256);)r+=this[e+s]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,s=0;++s<t&&(o*=256);)r+=this[e+s]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,o=1,s=this[e+--r];r>0&&(o*=256);)s+=this[e+--r]*o;return s>=(o*=128)&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||q(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,s=0;for(this[t]=255&e;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||q(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var s=0,i=1,a=0;for(this[t]=255&e;++s<n&&(i*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/i>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var s=n-1,i=1,a=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/i>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,s=r-n;if(this===e&&n<t&&t<r)for(o=s-1;o>=0;--o)e[o+t]=this[o+n];else if(s<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var i=c.isBuffer(e)?e:z(new c(e,r).toString()),a=i.length;for(s=0;s<n-t;++s)this[s+t]=i[s%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var n;t=t||1/0;for(var r=e.length,o=null,s=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&s.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function L(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super("HTTP error "+e.status),this.response=e,this.status=e.status}}t.HttpError=r;class o extends r{constructor(e,t){super(e),this.body=t,this.body.title&&(this.message="HTTP Error "+this.status+": "+this.body.title)}}t.Problem=o,t.default=async function(e){const t=e.headers.get("Content-Type");if(t&&t.match(/^application\/problem\+json/i)){const t=await e.json();return new o(e,t)}return new r(e)}},function(e,t,n){"use strict";function r(e){const t=new Headers;for(const n of e)if(n instanceof Headers)for(const e of n.keys())t.set(e,n.get(e));else if(n)for(const e of Object.keys(n))t.set(e,n[e]);return t}Object.defineProperty(t,"__esModule",{value:!0}),n(12),t.createFetchRequest=function(e,t,n){const o={};return t?Object.assign(o,n,t):Object.assign(o,n),o.headers=r([n?n.headers:null,e instanceof Request?e.headers:null,t&&t.headers?t.headers:null]),new Request(e,o)},t.mergeHeaders=r},function(e,t,n){e.exports=n(31)},function(e,t,n){"use strict";let r=n(32);r.keys().forEach(e=>{r(e)}),(r=n(78)).keys().forEach(e=>{r(e)})},function(e,t,n){var r={"./followable-promise.ts":33,"./ketting.ts":56,"./link.ts":76,"./representor/html.ts":77};function o(e){var t=s(e);return n(t)}function s(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id=32},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(24));describe("FollowablePromise",()=>{describe(".then()",()=>{it("should work when resolving",async()=>{const e=new s.default(e=>{e("hi")});o.expect(await e).to.equal("hi")}),it("should work when rejecting",async()=>{const e=new s.default((e,t)=>{t("hi")});let t=!1;try{await e}catch(e){t=e}o.expect(t).to.equal("hi")})}),describe(".follow()",()=>{it("should call follow function of resolved value",async()=>{const e=new s.default(e=>{e({follow:(e,t)=>"follow:"+e+":"+t.B})});o.expect(await e.follow("A",{B:"C"}),"follow:A:C")}),it("should bubble up exceptions from follow",async()=>{const e=new s.default(e=>{e({follow(){throw new Error("Hi")}})});let t=null;try{await e.follow("foo")}catch(e){t=e}o.expect(t.message).to.equal("Hi")})})})},function(e,t,n){
/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Dependencies that are used for multiple exports are required here only once
 */
var r=n(35);
/*!
 * test utility
 */t.test=n(36),
/*!
 * type utility
 */
t.type=n(13),
/*!
 * expectTypes utility
 */
t.expectTypes=n(37),
/*!
 * message utility
 */
t.getMessage=n(38),
/*!
 * actual utility
 */
t.getActual=n(19),
/*!
 * Inspect util
 */
t.inspect=n(15),
/*!
 * Object Display util
 */
t.objDisplay=n(20),
/*!
 * Flag utility
 */
t.flag=n(2),
/*!
 * Flag transferring utility
 */
t.transferFlags=n(4),
/*!
 * Deep equal utility
 */
t.eql=n(40),
/*!
 * Deep path info
 */
t.getPathInfo=r.getPathInfo,
/*!
 * Check if a property exists
 */
t.hasProperty=r.hasProperty,
/*!
 * Function name
 */
t.getName=n(21),
/*!
 * add Property
 */
t.addProperty=n(41),
/*!
 * add Method
 */
t.addMethod=n(42),
/*!
 * overwrite Property
 */
t.overwriteProperty=n(43),
/*!
 * overwrite Method
 */
t.overwriteMethod=n(44),
/*!
 * Add a chainable method
 */
t.addChainableMethod=n(45),
/*!
 * Overwrite chainable method
 */
t.overwriteChainableMethod=n(46),
/*!
 * Compare by inspect method
 */
t.compareByInspect=n(47),
/*!
 * Get own enumerable property symbols method
 */
t.getOwnEnumerablePropertySymbols=n(23),
/*!
 * Get own enumerable properties method
 */
t.getOwnEnumerableProperties=n(48),
/*!
 * Checks error against a given set of criteria
 */
t.checkError=n(49),
/*!
 * Proxify util
 */
t.proxify=n(9),
/*!
 * addLengthGuard util
 */
t.addLengthGuard=n(8),
/*!
 * isProxyEnabled helper
 */
t.isProxyEnabled=n(7),
/*!
 * isNaN method
 */
t.isNaN=n(50)},function(e,t,n){"use strict";function r(e,t){return void 0!==e&&null!==e&&t in Object(e)}function o(e){return e.replace(/([^\\])\[/g,"$1.[").match(/(\\\.|[^.]+?)+/g).map(function(e){var t=/^\[(\d+)\]$/.exec(e);return t?{i:parseFloat(t[1])}:{p:e.replace(/\\([.\[\]])/g,"$1")}})}function s(e,t,n){var r=e,o=null;n=void 0===n?t.length:n;for(var s=0;s<n;s++){var i=t[s];r&&(r=void 0===i.p?r[i.i]:r[i.p],s===n-1&&(o=r))}return o}function i(e,t){var n=o(t),i=n[n.length-1],a={parent:n.length>1?s(e,n,n.length-1):e,name:i.p||i.i,value:s(e,n)};return a.exists=r(a.parent,a.name),a}e.exports={hasProperty:r,getPathInfo:i,getPathValue:function(e,t){return i(e,t).value},setPathValue:function(e,t,n){return function(e,t,n){for(var r=e,o=n.length,s=null,i=0;i<o;i++){var a=null,c=null;if(s=n[i],i===o-1)r[a=void 0===s.p?s.i:s.p]=t;else if(void 0!==s.p&&r[s.p])r=r[s.p];else if(void 0!==s.i&&r[s.i])r=r[s.i];else{var u=n[i+1];a=void 0===s.p?s.i:s.p,c=void 0===u.p?[]:{},r[a]=c,r=r[a]}}}(e,n,o(t)),e}}},function(e,t,n){
/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(2);e.exports=function(e,t){var n=r(e,"negate"),o=t[0];return n?!o:o}},function(e,t,n){
/*!
 * Chai - expectTypes utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(18),o=n(2),s=n(13);e.exports=function(e,t){var n=o(e,"message"),i=o(e,"ssfi");n=n?n+": ":"",e=o(e,"object"),(t=t.map(function(e){return e.toLowerCase()})).sort();var a=t.map(function(e,n){var r=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an":"a";return(t.length>1&&n===t.length-1?"or ":"")+r+" "+e}).join(", "),c=s(e).toLowerCase();if(!t.some(function(e){return c===e}))throw new r(n+"object tested must be "+a+", but "+c+" given",void 0,i)}},function(e,t,n){
/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(2),o=n(19),s=n(20);e.exports=function(e,t){var n=r(e,"negate"),i=r(e,"object"),a=t[3],c=o(e,t),u=n?t[2]:t[1],h=r(e,"message");return"function"==typeof u&&(u=u()),u=(u=u||"").replace(/#\{this\}/g,function(){return s(i)}).replace(/#\{act\}/g,function(){return s(c)}).replace(/#\{exp\}/g,function(){return s(a)}),h?h+": "+u:u}},function(e,t){
/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=[];for(var n in e)t.push(n);return t}},function(e,t,n){"use strict";
/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */var r=n(13);function o(){this._key="chai/deep-eql__"+Math.random()+Date.now()}o.prototype={get:function(e){return e[this._key]},set:function(e,t){Object.isExtensible(e)&&Object.defineProperty(e,this._key,{value:t,configurable:!0})}};var s="function"==typeof WeakMap?WeakMap:o;
/*!
 * Check to see if the MemoizeMap has recorded a result of the two operands
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @returns {Boolean|null} result
*/function i(e,t,n){if(!n||w(e)||w(t))return null;var r=n.get(e);if(r){var o=r.get(t);if("boolean"==typeof o)return o}return null}
/*!
 * Set the result of the equality into the MemoizeMap
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @param {Boolean} result
*/function a(e,t,n,r){if(n&&!w(e)&&!w(t)){var o=n.get(e);o?o.set(t,r):((o=new s).set(t,r),n.set(e,o))}}
/*!
 * Primary Export
 */function c(e,t,n){if(n&&n.comparator)return h(e,t,n);var r=u(e,t);return null!==r?r:h(e,t,n)}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t||!w(e)&&!w(t)&&null}
/*!
 * The main logic of the `deepEqual` function.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (optional) Additional options
 * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.
 * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of
    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular
    references to blow the stack.
 * @return {Boolean} equal match
*/function h(e,t,n){(n=n||{}).memoize=!1!==n.memoize&&(n.memoize||new s);var o=n&&n.comparator,h=i(e,t,n.memoize);if(null!==h)return h;var w=i(t,e,n.memoize);if(null!==w)return w;if(o){var g=o(e,t);if(!1===g||!0===g)return a(e,t,n.memoize,g),g;var b=u(e,t);if(null!==b)return b}var m=r(e);if(m!==r(t))return a(e,t,n.memoize,!1),!1;a(e,t,n.memoize,!0);var v=function(e,t,n,r){switch(n){case"String":case"Number":case"Boolean":case"Date":return c(e.valueOf(),t.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":case"Error":return e===t;case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return f(e,t,r);case"RegExp":
/*!
 * Compare two Regular Expressions for equality.
 *
 * @param {RegExp} leftHandOperand
 * @param {RegExp} rightHandOperand
 * @return {Boolean} result
 */
return function(e,t){return e.toString()===t.toString()}
/*!
 * Compare two Sets/Maps for equality. Faster than other equality functions.
 *
 * @param {Set} leftHandOperand
 * @param {Set} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */(e,t);case"Generator":
/*!
 * Simple equality for generator objects such as those returned by generator functions.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,n){return f(d(e),d(t),n)}
/*!
 * Determine if the given object has an @@iterator function.
 *
 * @param {Object} target
 * @return {Boolean} `true` if the object has an @@iterator function.
 */(e,t,r);case"DataView":return f(new Uint8Array(e.buffer),new Uint8Array(t.buffer),r);case"ArrayBuffer":return f(new Uint8Array(e),new Uint8Array(t),r);case"Set":case"Map":return l(e,t,r);default:
/*!
 * Recursively check the equality of two Objects. Once basic sameness has been established it will defer to `deepEqual`
 * for each enumerable key in the object.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,n){var r=y(e),o=y(t);if(r.length&&r.length===o.length)return r.sort(),o.sort(),!1!==f(r,o)&&
/*!
 * Determines if two objects have matching values, given a set of keys. Defers to deepEqual for the equality check of
 * each key. If any value of the given key is not equal, the function will return false (early).
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Array} keys An array of keys to compare the values of leftHandOperand and rightHandOperand against
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
function(e,t,n,r){var o=n.length;if(0===o)return!0;for(var s=0;s<o;s+=1)if(!1===c(e[n[s]],t[n[s]],r))return!1;return!0}(e,t,r,n);var s=p(e),i=p(t);if(s.length&&s.length===i.length)return s.sort(),i.sort(),f(s,i,n);if(0===r.length&&0===s.length&&0===o.length&&0===i.length)return!0;return!1}
/*!
 * Returns true if the argument is a primitive.
 *
 * This intentionally returns true for all objects that can be compared by reference,
 * including functions and symbols.
 *
 * @param {Mixed} value
 * @return {Boolean} result
 */(e,t,r)}}(e,t,m,n);return a(e,t,n.memoize,v),v}function l(e,t,n){if(e.size!==t.size)return!1;if(0===e.size)return!0;var r=[],o=[];return e.forEach(function(e,t){r.push([e,t])}),t.forEach(function(e,t){o.push([e,t])}),f(r.sort(),o.sort(),n)}
/*!
 * Simple equality for flat iterable objects such as Arrays, TypedArrays or Node.js buffers.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function f(e,t,n){var r=e.length;if(r!==t.length)return!1;if(0===r)return!0;for(var o=-1;++o<r;)if(!1===c(e[o],t[o],n))return!1;return!0}
/*!
 * Gets all iterator entries from the given Object. If the Object has no @@iterator function, returns an empty array.
 * This will consume the iterator - which could have side effects depending on the @@iterator implementation.
 *
 * @param {Object} target
 * @returns {Array} an array of entries from the @@iterator function
 */
function p(e){if(function(e){return"undefined"!=typeof Symbol&&"object"==typeof e&&void 0!==Symbol.iterator&&"function"==typeof e[Symbol.iterator]}(e))try{return d(e[Symbol.iterator]())}catch(e){return[]}return[]}
/*!
 * Gets all entries from a Generator. This will consume the generator - which could have side effects.
 *
 * @param {Generator} target
 * @returns {Array} an array of entries from the Generator.
 */function d(e){for(var t=e.next(),n=[t.value];!1===t.done;)t=e.next(),n.push(t.value);return n}
/*!
 * Gets all own and inherited enumerable keys from a target.
 *
 * @param {Object} target
 * @returns {Array} an array of own and inherited enumerable keys from the target.
 */function y(e){var t=[];for(var n in e)t.push(n);return t}function w(e){return null===e||"object"!=typeof e}e.exports=c,e.exports.MemoizeMap=s},function(e,t,n){
/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(3),o=n(2),s=n(7),i=n(4);e.exports=function(e,t,n){n=void 0===n?function(){}:n,Object.defineProperty(e,t,{get:function e(){s()||o(this,"lockSsfi")||o(this,"ssfi",e);var t=n.call(this);if(void 0!==t)return t;var a=new r.Assertion;return i(this,a),a},configurable:!0})}},function(e,t,n){
/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(8),o=n(3),s=n(2),i=n(9),a=n(4);e.exports=function(e,t,n){var c=function(){s(this,"lockSsfi")||s(this,"ssfi",c);var e=n.apply(this,arguments);if(void 0!==e)return e;var t=new o.Assertion;return a(this,t),t};r(c,t,!1),e[t]=i(c,t)}},function(e,t,n){
/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(3),o=n(2),s=n(7),i=n(4);e.exports=function(e,t,n){var a=Object.getOwnPropertyDescriptor(e,t),c=function(){};a&&"function"==typeof a.get&&(c=a.get),Object.defineProperty(e,t,{get:function e(){s()||o(this,"lockSsfi")||o(this,"ssfi",e);var t=o(this,"lockSsfi");o(this,"lockSsfi",!0);var a=n(c).call(this);if(o(this,"lockSsfi",t),void 0!==a)return a;var u=new r.Assertion;return i(this,u),u},configurable:!0})}},function(e,t,n){
/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(8),o=n(3),s=n(2),i=n(9),a=n(4);e.exports=function(e,t,n){var c=e[t],u=function(){throw new Error(t+" is not a function")};c&&"function"==typeof c&&(u=c);var h=function(){s(this,"lockSsfi")||s(this,"ssfi",h);var e=s(this,"lockSsfi");s(this,"lockSsfi",!0);var t=n(u).apply(this,arguments);if(s(this,"lockSsfi",e),void 0!==t)return t;var r=new o.Assertion;return a(this,r),r};r(h,t,!1),e[t]=i(h,t)}},function(e,t,n){
/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(8),o=n(3),s=n(2),i=n(9),a=n(4),c="function"==typeof Object.setPrototypeOf,u=function(){},h=Object.getOwnPropertyNames(u).filter(function(e){var t=Object.getOwnPropertyDescriptor(u,e);return"object"!=typeof t||!t.configurable}),l=Function.prototype.call,f=Function.prototype.apply;e.exports=function(e,t,n,u){"function"!=typeof u&&(u=function(){});var p={method:n,chainingBehavior:u};e.__methods||(e.__methods={}),e.__methods[t]=p,Object.defineProperty(e,t,{get:function(){p.chainingBehavior.call(this);var n=function(){s(this,"lockSsfi")||s(this,"ssfi",n);var e=p.method.apply(this,arguments);if(void 0!==e)return e;var t=new o.Assertion;return a(this,t),t};if(r(n,t,!0),c){var u=Object.create(this);u.call=l,u.apply=f,Object.setPrototypeOf(n,u)}else{Object.getOwnPropertyNames(e).forEach(function(t){if(-1===h.indexOf(t)){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r)}})}return a(this,n),i(n)},configurable:!0})}},function(e,t,n){
/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(3),o=n(4);e.exports=function(e,t,n,s){var i=e.__methods[t],a=i.chainingBehavior;i.chainingBehavior=function(){var e=s(a).call(this);if(void 0!==e)return e;var t=new r.Assertion;return o(this,t),t};var c=i.method;i.method=function(){var e=n(c).apply(this,arguments);if(void 0!==e)return e;var t=new r.Assertion;return o(this,t),t}}},function(e,t,n){
/*!
 * Chai - compareByInspect utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(15);e.exports=function(e,t){return r(e)<r(t)?-1:1}},function(e,t,n){
/*!
 * Chai - getOwnEnumerableProperties utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(23);e.exports=function(e){return Object.keys(e).concat(r(e))}},function(e,t,n){"use strict";var r=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\(\/]+)/;function o(e){var t="";if(void 0===e.name){var n=String(e).match(r);n&&(t=n[1])}else t=e.name;return t}e.exports={compatibleInstance:function(e,t){return t instanceof Error&&e===t},compatibleConstructor:function(e,t){return t instanceof Error?e.constructor===t.constructor||e instanceof t.constructor:(t.prototype instanceof Error||t===Error)&&(e.constructor===t||e instanceof t)},compatibleMessage:function(e,t){var n="string"==typeof e?e:e.message;return t instanceof RegExp?t.test(n):"string"==typeof t&&-1!==n.indexOf(t)},getMessage:function(e){var t="";return e&&e.message?t=e.message:"string"==typeof e&&(t=e),t},getConstructorName:function(e){var t=e;return e instanceof Error?t=o(e.constructor):"function"==typeof e&&(t=o(e).trim()||o(new e)),t}}},function(e,t){e.exports=Number.isNaN||
/*!
 * Chai - isNaN utility
 * Copyright(c) 2012-2015 Sakthipriyan Vairamani <thechargingvolcano@gmail.com>
 * MIT Licensed
 */
function(e){return e!=e}},function(e,t,n){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(5);e.exports=function(e,t){
/*!
   * Module dependencies.
   */
var n=e.AssertionError,o=t.flag;
/*!
   * Module export.
   */
/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * `Assertion` objects contain metadata in the form of flags. Three flags can
   * be assigned during instantiation by passing arguments to this constructor:
   *
   * - `object`: This flag contains the target of the assertion. For example, in
   *   the assertion `expect(numKittens).to.equal(7);`, the `object` flag will
   *   contain `numKittens` so that the `equal` assertion can reference it when
   *   needed.
   *
   * - `message`: This flag contains an optional custom error message to be
   *   prepended to the error message that's generated by the assertion when it
   *   fails.
   *
   * - `ssfi`: This flag stands for "start stack function indicator". It
   *   contains a function reference that serves as the starting point for
   *   removing frames from the stack trace of the error that's created by the
   *   assertion when it fails. The goal is to provide a cleaner stack trace to
   *   end users by removing Chai's internal functions. Note that it only works
   *   in environments that support `Error.captureStackTrace`, and only when
   *   `Chai.config.includeStack` hasn't been set to `false`.
   *
   * - `lockSsfi`: This flag controls whether or not the given `ssfi` flag
   *   should retain its current value, even as assertions are chained off of
   *   this object. This is usually set to `true` when creating a new assertion
   *   from within another assertion. It's also temporarily set to `true` before
   *   an overwritten assertion gets called by the overwriting assertion.
   *
   * @param {Mixed} obj target of the assertion
   * @param {String} msg (optional) custom error message
   * @param {Function} ssfi (optional) starting point for removing stack frames
   * @param {Boolean} lockSsfi (optional) whether or not the ssfi flag is locked
   * @api private
   */
function s(e,n,r,i){return o(this,"ssfi",r||s),o(this,"lockSsfi",i),o(this,"object",e),o(this,"message",n),t.proxify(this)}e.Assertion=s,Object.defineProperty(s,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=e}}),Object.defineProperty(s,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=e}}),s.addProperty=function(e,n){t.addProperty(this.prototype,e,n)},s.addMethod=function(e,n){t.addMethod(this.prototype,e,n)},s.addChainableMethod=function(e,n,r){t.addChainableMethod(this.prototype,e,n,r)},s.overwriteProperty=function(e,n){t.overwriteProperty(this.prototype,e,n)},s.overwriteMethod=function(e,n){t.overwriteMethod(this.prototype,e,n)},s.overwriteChainableMethod=function(e,n,r){t.overwriteChainableMethod(this.prototype,e,n,r)},s.prototype.assert=function(e,s,i,a,c,u){var h=t.test(this,arguments);if(!1!==u&&(u=!0),void 0===a&&void 0===c&&(u=!1),!0!==r.showDiff&&(u=!1),!h){s=t.getMessage(this,arguments);var l=t.getActual(this,arguments);throw new n(s,{actual:l,expected:a,showDiff:u},r.includeStack?this.assert:o(this,"ssfi"))}},
/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */
Object.defineProperty(s.prototype,"_obj",{get:function(){return o(this,"object")},set:function(e){o(this,"object",e)}})}},function(e,t){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var n=e.Assertion,r=e.AssertionError,o=t.flag;function s(e,n){n&&o(this,"message",n),e=e.toLowerCase();var r=o(this,"object"),s=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(r).toLowerCase(),"expected #{this} to be "+s+e,"expected #{this} not to be "+s+e)}function i(e,n){return t.isNaN(e)&&t.isNaN(n)||e===n}function a(){o(this,"contains",!0)}function c(e,s){s&&o(this,"message",s);var a=o(this,"object"),c=t.type(a).toLowerCase(),u=o(this,"message"),h=o(this,"negate"),l=o(this,"ssfi"),f=o(this,"deep"),p=f?"deep ":"";u=u?u+": ":"";var d=!1;switch(c){case"string":d=-1!==a.indexOf(e);break;case"weakset":if(f)throw new r(u+"unable to use .deep.include with WeakSet",void 0,l);d=a.has(e);break;case"map":var y=f?t.eql:i;a.forEach(function(t){d=d||y(t,e)});break;case"set":f?a.forEach(function(n){d=d||t.eql(n,e)}):d=a.has(e);break;case"array":d=f?a.some(function(n){return t.eql(n,e)}):-1!==a.indexOf(e);break;default:if(e!==Object(e))throw new r(u+"object tested must be an array, a map, an object, a set, a string, or a weakset, but "+c+" given",void 0,l);var w=Object.keys(e),g=null,b=0;if(w.forEach(function(s){var i=new n(a);if(t.transferFlags(this,i,!0),o(i,"lockSsfi",!0),h&&1!==w.length)try{i.property(s,e[s])}catch(e){if(!t.checkError.compatibleConstructor(e,r))throw e;null===g&&(g=e),b++}else i.property(s,e[s])},this),h&&w.length>1&&b===w.length)throw g;return}this.assert(d,"expected #{this} to "+p+"include "+t.inspect(e),"expected #{this} to not "+p+"include "+t.inspect(e))}function u(){var e=o(this,"object"),n=t.type(e);this.assert("Arguments"===n,"expected #{this} to be arguments but got "+n,"expected #{this} to not be arguments")}function h(e,t){t&&o(this,"message",t);var n=o(this,"object");if(o(this,"deep")){var r=o(this,"lockSsfi");o(this,"lockSsfi",!0),this.eql(e),o(this,"lockSsfi",r)}else this.assert(e===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function l(e,n){n&&o(this,"message",n),this.assert(t.eql(e,o(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function f(e,s){s&&o(this,"message",s);var i,a=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),h=u?u+": ":"",l=o(this,"ssfi"),f=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==f&&"set"!==f&&new n(a,u,l,!0).to.have.property("length"),c||"date"!==f||"date"===p)if("number"===p||!c&&"number"!==f)if(c||"date"===f||"number"===f)d=!1;else{i=h+"expected "+("string"===f?"'"+a+"'":a)+" to be a number or a date"}else i=h+"the argument to above must be a number";else i=h+"the argument to above must be a date";if(d)throw new r(i,void 0,l);if(c){var y,w="length";"map"===f||"set"===f?(w="size",y=a.size):y=a.length,this.assert(y>e,"expected #{this} to have a "+w+" above #{exp} but got #{act}","expected #{this} to not have a "+w+" above #{exp}",e,y)}else this.assert(a>e,"expected #{this} to be above #{exp}","expected #{this} to be at most #{exp}",e)}function p(e,s){s&&o(this,"message",s);var i,a=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),h=u?u+": ":"",l=o(this,"ssfi"),f=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==f&&"set"!==f&&new n(a,u,l,!0).to.have.property("length"),c||"date"!==f||"date"===p)if("number"===p||!c&&"number"!==f)if(c||"date"===f||"number"===f)d=!1;else{i=h+"expected "+("string"===f?"'"+a+"'":a)+" to be a number or a date"}else i=h+"the argument to least must be a number";else i=h+"the argument to least must be a date";if(d)throw new r(i,void 0,l);if(c){var y,w="length";"map"===f||"set"===f?(w="size",y=a.size):y=a.length,this.assert(y>=e,"expected #{this} to have a "+w+" at least #{exp} but got #{act}","expected #{this} to have a "+w+" below #{exp}",e,y)}else this.assert(a>=e,"expected #{this} to be at least #{exp}","expected #{this} to be below #{exp}",e)}function d(e,s){s&&o(this,"message",s);var i,a=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),h=u?u+": ":"",l=o(this,"ssfi"),f=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==f&&"set"!==f&&new n(a,u,l,!0).to.have.property("length"),c||"date"!==f||"date"===p)if("number"===p||!c&&"number"!==f)if(c||"date"===f||"number"===f)d=!1;else{i=h+"expected "+("string"===f?"'"+a+"'":a)+" to be a number or a date"}else i=h+"the argument to below must be a number";else i=h+"the argument to below must be a date";if(d)throw new r(i,void 0,l);if(c){var y,w="length";"map"===f||"set"===f?(w="size",y=a.size):y=a.length,this.assert(y<e,"expected #{this} to have a "+w+" below #{exp} but got #{act}","expected #{this} to not have a "+w+" below #{exp}",e,y)}else this.assert(a<e,"expected #{this} to be below #{exp}","expected #{this} to be at least #{exp}",e)}function y(e,s){s&&o(this,"message",s);var i,a=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),h=u?u+": ":"",l=o(this,"ssfi"),f=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==f&&"set"!==f&&new n(a,u,l,!0).to.have.property("length"),c||"date"!==f||"date"===p)if("number"===p||!c&&"number"!==f)if(c||"date"===f||"number"===f)d=!1;else{i=h+"expected "+("string"===f?"'"+a+"'":a)+" to be a number or a date"}else i=h+"the argument to most must be a number";else i=h+"the argument to most must be a date";if(d)throw new r(i,void 0,l);if(c){var y,w="length";"map"===f||"set"===f?(w="size",y=a.size):y=a.length,this.assert(y<=e,"expected #{this} to have a "+w+" at most #{exp} but got #{act}","expected #{this} to have a "+w+" above #{exp}",e,y)}else this.assert(a<=e,"expected #{this} to be at most #{exp}","expected #{this} to be above #{exp}",e)}function w(e,n){n&&o(this,"message",n);var s=o(this,"object"),i=o(this,"ssfi"),a=o(this,"message");try{var c=s instanceof e}catch(n){if(n instanceof TypeError)throw new r((a=a?a+": ":"")+"The instanceof assertion needs a constructor but "+t.type(e)+" was given.",void 0,i);throw n}var u=t.getName(e);null===u&&(u="an unnamed constructor"),this.assert(c,"expected #{this} to be an instance of "+u,"expected #{this} to not be an instance of "+u)}function g(e,n,s){s&&o(this,"message",s);var i=o(this,"nested"),a=o(this,"own"),c=o(this,"message"),u=o(this,"object"),h=o(this,"ssfi"),l=typeof e;if(c=c?c+": ":"",i){if("string"!==l)throw new r(c+"the argument to property must be a string when using nested syntax",void 0,h)}else if("string"!==l&&"number"!==l&&"symbol"!==l)throw new r(c+"the argument to property must be a string, number, or symbol",void 0,h);if(i&&a)throw new r(c+'The "nested" and "own" flags cannot be combined.',void 0,h);if(null===u||void 0===u)throw new r(c+"Target cannot be null or undefined.",void 0,h);var f,p=o(this,"deep"),d=o(this,"negate"),y=i?t.getPathInfo(u,e):null,w=i?y.value:u[e],g="";p&&(g+="deep "),a&&(g+="own "),i&&(g+="nested "),g+="property ",f=a?Object.prototype.hasOwnProperty.call(u,e):i?y.exists:t.hasProperty(u,e),d&&1!==arguments.length||this.assert(f,"expected #{this} to have "+g+t.inspect(e),"expected #{this} to not have "+g+t.inspect(e)),arguments.length>1&&this.assert(f&&(p?t.eql(n,w):n===w),"expected #{this} to have "+g+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have "+g+t.inspect(e)+" of #{act}",n,w),o(this,"object",w)}function b(e,t,n){o(this,"own",!0),g.apply(this,arguments)}function m(e,n,r){"string"==typeof n&&(r=n,n=null),r&&o(this,"message",r);var s=o(this,"object"),i=Object.getOwnPropertyDescriptor(Object(s),e);i&&n?this.assert(t.eql(n,i),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to match "+t.inspect(n)+", got "+t.inspect(i),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to not match "+t.inspect(n),n,i,!0):this.assert(i,"expected #{this} to have an own property descriptor for "+t.inspect(e),"expected #{this} to not have an own property descriptor for "+t.inspect(e)),o(this,"object",i)}function v(){o(this,"doLength",!0)}function x(e,r){r&&o(this,"message",r);var s,i=o(this,"object"),a=t.type(i).toLowerCase(),c=o(this,"message"),u=o(this,"ssfi"),h="length";switch(a){case"map":case"set":h="size",s=i.size;break;default:new n(i,c,u,!0).to.have.property("length"),s=i.length}this.assert(s==e,"expected #{this} to have a "+h+" of #{exp} but got #{act}","expected #{this} to not have a "+h+" of #{act}",e,s)}function j(e,t){t&&o(this,"message",t);var n=o(this,"object");this.assert(e.exec(n),"expected #{this} to match "+e,"expected #{this} not to match "+e)}function _(e){var n,s,i=o(this,"object"),a=t.type(i),c=t.type(e),u=o(this,"ssfi"),h=o(this,"deep"),l="",f=!0,p=o(this,"message"),d=(p=p?p+": ":"")+"when testing keys against an object or an array you must give a single Array|Object|String argument or multiple String arguments";if("Map"===a||"Set"===a)l=h?"deeply ":"",s=[],i.forEach(function(e,t){s.push(t)}),"Array"!==c&&(e=Array.prototype.slice.call(arguments));else{switch(s=t.getOwnEnumerableProperties(i),c){case"Array":if(arguments.length>1)throw new r(d,void 0,u);break;case"Object":if(arguments.length>1)throw new r(d,void 0,u);e=Object.keys(e);break;default:e=Array.prototype.slice.call(arguments)}e=e.map(function(e){return"symbol"==typeof e?e:String(e)})}if(!e.length)throw new r(p+"keys required",void 0,u);var y=e.length,w=o(this,"any"),g=o(this,"all"),b=e;if(w||g||(g=!0),w&&(f=b.some(function(e){return s.some(function(n){return h?t.eql(e,n):e===n})})),g&&(f=b.every(function(e){return s.some(function(n){return h?t.eql(e,n):e===n})}),o(this,"contains")||(f=f&&e.length==s.length)),y>1){var m=(e=e.map(function(e){return t.inspect(e)})).pop();g&&(n=e.join(", ")+", and "+m),w&&(n=e.join(", ")+", or "+m)}else n=t.inspect(e[0]);n=(y>1?"keys ":"key ")+n,n=(o(this,"contains")?"contain ":"have ")+n,this.assert(f,"expected #{this} to "+l+n,"expected #{this} to not "+l+n,b.slice(0).sort(t.compareByInspect),s.sort(t.compareByInspect),!0)}function k(e,r,s){s&&o(this,"message",s);var i,a=o(this,"object"),c=o(this,"ssfi"),u=o(this,"message"),h=o(this,"negate")||!1;new n(a,u,c,!0).is.a("function"),(e instanceof RegExp||"string"==typeof e)&&(r=e,e=null);try{a()}catch(e){i=e}var l=void 0===e&&void 0===r,f=Boolean(e&&r),p=!1,d=!1;if(l||!l&&!h){var y="an error";e instanceof Error?y="#{exp}":e&&(y=t.checkError.getConstructorName(e)),this.assert(i,"expected #{this} to throw "+y,"expected #{this} to not throw an error but #{act} was thrown",e&&e.toString(),i instanceof Error?i.toString():"string"==typeof i?i:i&&t.checkError.getConstructorName(i))}if(e&&i){if(e instanceof Error)t.checkError.compatibleInstance(i,e)===h&&(f&&h?p=!0:this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(i&&!h?" but #{act} was thrown":""),e.toString(),i.toString()));t.checkError.compatibleConstructor(i,e)===h&&(f&&h?p=!0:this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(i?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),i instanceof Error?i.toString():i&&t.checkError.getConstructorName(i)))}if(i&&void 0!==r&&null!==r){var w="including";r instanceof RegExp&&(w="matching"),t.checkError.compatibleMessage(i,r)===h&&(f&&h?d=!0:this.assert(h,"expected #{this} to throw error "+w+" #{exp} but got #{act}","expected #{this} to throw error not "+w+" #{exp}",r,t.checkError.getMessage(i)))}p&&d&&this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(i?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),i instanceof Error?i.toString():i&&t.checkError.getConstructorName(i)),o(this,"object",i)}function O(e,n){n&&o(this,"message",n);var r=o(this,"object"),s=o(this,"itself"),i="function"!=typeof r||s?r[e]:r.prototype[e];this.assert("function"==typeof i,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}function A(e,n){n&&o(this,"message",n);var r=e(o(this,"object"));this.assert(r,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),!o(this,"negate"),r)}function T(e,t,s){s&&o(this,"message",s);var i=o(this,"object"),a=o(this,"message"),c=o(this,"ssfi");if(new n(i,a,c,!0).is.a("number"),"number"!=typeof e||"number"!=typeof t)throw new r((a=a?a+": ":"")+"the arguments to closeTo or approximately must be numbers",void 0,c);this.assert(Math.abs(i-e)<=t,"expected #{this} to be close to "+e+" +/- "+t,"expected #{this} not to be close to "+e+" +/- "+t)}function E(e,t,r){r&&o(this,"message",r);var s,i=o(this,"object"),a=o(this,"message"),c=o(this,"ssfi");new n(i,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),s=e[t]):(new n(e,a,c,!0).is.a("function"),s=e()),i();var u=void 0===t||null===t?e():e[t],h=void 0===t||null===t?s:"."+t;o(this,"deltaMsgObj",h),o(this,"initialDeltaValue",s),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","change"),o(this,"realDelta",u!==s),this.assert(s!==u,"expected "+h+" to change","expected "+h+" to not change")}function P(e,t,r){r&&o(this,"message",r);var s,i=o(this,"object"),a=o(this,"message"),c=o(this,"ssfi");new n(i,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),s=e[t]):(new n(e,a,c,!0).is.a("function"),s=e()),new n(s,a,c,!0).is.a("number"),i();var u=void 0===t||null===t?e():e[t],h=void 0===t||null===t?s:"."+t;o(this,"deltaMsgObj",h),o(this,"initialDeltaValue",s),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","increase"),o(this,"realDelta",u-s),this.assert(u-s>0,"expected "+h+" to increase","expected "+h+" to not increase")}function S(e,t,r){r&&o(this,"message",r);var s,i=o(this,"object"),a=o(this,"message"),c=o(this,"ssfi");new n(i,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),s=e[t]):(new n(e,a,c,!0).is.a("function"),s=e()),new n(s,a,c,!0).is.a("number"),i();var u=void 0===t||null===t?e():e[t],h=void 0===t||null===t?s:"."+t;o(this,"deltaMsgObj",h),o(this,"initialDeltaValue",s),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","decrease"),o(this,"realDelta",s-u),this.assert(u-s<0,"expected "+h+" to decrease","expected "+h+" to not decrease")}["to","be","been","is","and","has","have","with","that","which","at","of","same","but","does","still"].forEach(function(e){n.addProperty(e)}),n.addProperty("not",function(){o(this,"negate",!0)}),n.addProperty("deep",function(){o(this,"deep",!0)}),n.addProperty("nested",function(){o(this,"nested",!0)}),n.addProperty("own",function(){o(this,"own",!0)}),n.addProperty("ordered",function(){o(this,"ordered",!0)}),n.addProperty("any",function(){o(this,"any",!0),o(this,"all",!1)}),n.addProperty("all",function(){o(this,"all",!0),o(this,"any",!1)}),n.addChainableMethod("an",s),n.addChainableMethod("a",s),n.addChainableMethod("include",c,a),n.addChainableMethod("contain",c,a),n.addChainableMethod("contains",c,a),n.addChainableMethod("includes",c,a),n.addProperty("ok",function(){this.assert(o(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),n.addProperty("true",function(){this.assert(!0===o(this,"object"),"expected #{this} to be true","expected #{this} to be false",!o(this,"negate"))}),n.addProperty("false",function(){this.assert(!1===o(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!o(this,"negate"))}),n.addProperty("null",function(){this.assert(null===o(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),n.addProperty("undefined",function(){this.assert(void 0===o(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),n.addProperty("NaN",function(){this.assert(t.isNaN(o(this,"object")),"expected #{this} to be NaN","expected #{this} not to be NaN")}),n.addProperty("exist",function(){var e=o(this,"object");this.assert(null!==e&&void 0!==e,"expected #{this} to exist","expected #{this} to not exist")}),n.addProperty("empty",function(){var e,n=o(this,"object"),s=o(this,"ssfi"),i=o(this,"message");switch(i=i?i+": ":"",t.type(n).toLowerCase()){case"array":case"string":e=n.length;break;case"map":case"set":e=n.size;break;case"weakmap":case"weakset":throw new r(i+".empty was passed a weak collection",void 0,s);case"function":var a=i+".empty was passed a function "+t.getName(n);throw new r(a.trim(),void 0,s);default:if(n!==Object(n))throw new r(i+".empty was passed non-string primitive "+t.inspect(n),void 0,s);e=Object.keys(n).length}this.assert(0===e,"expected #{this} to be empty","expected #{this} not to be empty")}),n.addProperty("arguments",u),n.addProperty("Arguments",u),n.addMethod("equal",h),n.addMethod("equals",h),n.addMethod("eq",h),n.addMethod("eql",l),n.addMethod("eqls",l),n.addMethod("above",f),n.addMethod("gt",f),n.addMethod("greaterThan",f),n.addMethod("least",p),n.addMethod("gte",p),n.addMethod("below",d),n.addMethod("lt",d),n.addMethod("lessThan",d),n.addMethod("most",y),n.addMethod("lte",y),n.addMethod("within",function(e,s,i){i&&o(this,"message",i);var a,c=o(this,"object"),u=o(this,"doLength"),h=o(this,"message"),l=h?h+": ":"",f=o(this,"ssfi"),p=t.type(c).toLowerCase(),d=t.type(e).toLowerCase(),y=t.type(s).toLowerCase(),w=!0,g="date"===d&&"date"===y?e.toUTCString()+".."+s.toUTCString():e+".."+s;if(u&&"map"!==p&&"set"!==p&&new n(c,h,f,!0).to.have.property("length"),u||"date"!==p||"date"===d&&"date"===y)if("number"===d&&"number"===y||!u&&"number"!==p)if(u||"date"===p||"number"===p)w=!1;else{a=l+"expected "+("string"===p?"'"+c+"'":c)+" to be a number or a date"}else a=l+"the arguments to within must be numbers";else a=l+"the arguments to within must be dates";if(w)throw new r(a,void 0,f);if(u){var b,m="length";"map"===p||"set"===p?(m="size",b=c.size):b=c.length,this.assert(b>=e&&b<=s,"expected #{this} to have a "+m+" within "+g,"expected #{this} to not have a "+m+" within "+g)}else this.assert(c>=e&&c<=s,"expected #{this} to be within "+g,"expected #{this} to not be within "+g)}),n.addMethod("instanceof",w),n.addMethod("instanceOf",w),n.addMethod("property",g),n.addMethod("ownProperty",b),n.addMethod("haveOwnProperty",b),n.addMethod("ownPropertyDescriptor",m),n.addMethod("haveOwnPropertyDescriptor",m),n.addChainableMethod("length",x,v),n.addChainableMethod("lengthOf",x,v),n.addMethod("match",j),n.addMethod("matches",j),n.addMethod("string",function(e,r){r&&o(this,"message",r);var s=o(this,"object"),i=o(this,"message"),a=o(this,"ssfi");new n(s,i,a,!0).is.a("string"),this.assert(~s.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))}),n.addMethod("keys",_),n.addMethod("key",_),n.addMethod("throw",k),n.addMethod("throws",k),n.addMethod("Throw",k),n.addMethod("respondTo",O),n.addMethod("respondsTo",O),n.addProperty("itself",function(){o(this,"itself",!0)}),n.addMethod("satisfy",A),n.addMethod("satisfies",A),n.addMethod("closeTo",T),n.addMethod("approximately",T),n.addMethod("members",function(e,r){r&&o(this,"message",r);var s=o(this,"object"),i=o(this,"message"),a=o(this,"ssfi");new n(s,i,a,!0).to.be.an("array"),new n(e,i,a,!0).to.be.an("array");var c,u,h,l=o(this,"contains"),f=o(this,"ordered");l?(u="expected #{this} to be "+(c=f?"an ordered superset":"a superset")+" of #{exp}",h="expected #{this} to not be "+c+" of #{exp}"):(u="expected #{this} to have the same "+(c=f?"ordered members":"members")+" as #{exp}",h="expected #{this} to not have the same "+c+" as #{exp}");var p=o(this,"deep")?t.eql:void 0;this.assert(function(e,t,n,r,o){if(!r){if(e.length!==t.length)return!1;t=t.slice()}return e.every(function(e,s){if(o)return n?n(e,t[s]):e===t[s];if(!n){var i=t.indexOf(e);return-1!==i&&(r||t.splice(i,1),!0)}return t.some(function(o,s){return!!n(e,o)&&(r||t.splice(s,1),!0)})})}(e,s,p,l,f),u,h,e,s,!0)}),n.addMethod("oneOf",function(e,t){t&&o(this,"message",t);var r=o(this,"object"),s=o(this,"message"),i=o(this,"ssfi");new n(e,s,i,!0).to.be.an("array"),this.assert(e.indexOf(r)>-1,"expected #{this} to be one of #{exp}","expected #{this} to not be one of #{exp}",e,r)}),n.addMethod("change",E),n.addMethod("changes",E),n.addMethod("increase",P),n.addMethod("increases",P),n.addMethod("decrease",S),n.addMethod("decreases",S),n.addMethod("by",function(e,t){t&&o(this,"message",t);var n,r=o(this,"deltaMsgObj"),s=o(this,"initialDeltaValue"),i=o(this,"finalDeltaValue"),a=o(this,"deltaBehavior"),c=o(this,"realDelta");n="change"===a?Math.abs(i-s)===Math.abs(e):c===Math.abs(e),this.assert(n,"expected "+r+" to "+a+" by "+e,"expected "+r+" to not "+a+" by "+e)}),n.addProperty("extensible",function(){var e=o(this,"object"),t=e===Object(e)&&Object.isExtensible(e);this.assert(t,"expected #{this} to be extensible","expected #{this} to not be extensible")}),n.addProperty("sealed",function(){var e=o(this,"object"),t=e!==Object(e)||Object.isSealed(e);this.assert(t,"expected #{this} to be sealed","expected #{this} to not be sealed")}),n.addProperty("frozen",function(){var e=o(this,"object"),t=e!==Object(e)||Object.isFrozen(e);this.assert(t,"expected #{this} to be frozen","expected #{this} to not be frozen")}),n.addProperty("finite",function(e){var t=o(this,"object");this.assert("number"==typeof t&&isFinite(t),"expected #{this} to be a finite number","expected #{this} to not be a finite number")})}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){e.expect=function(t,n){return new e.Assertion(t,n)},e.expect.fail=function(t,n,r,o){throw arguments.length<2&&(r=t,t=void 0),r=r||"expect.fail()",new e.AssertionError(r,{actual:t,expected:n,operator:o},e.expect.fail)}}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var n=e.Assertion;function r(){Object.defineProperty(Object.prototype,"should",{set:function(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})},get:function e(){return this instanceof String||this instanceof Number||this instanceof Boolean||"function"==typeof Symbol&&this instanceof Symbol?new n(this.valueOf(),null,e):new n(this,null,e)},configurable:!0});var t={fail:function(n,r,o,s){throw arguments.length<2&&(o=n,n=void 0),o=o||"should.fail()",new e.AssertionError(o,{actual:n,expected:r,operator:s},t.fail)},equal:function(e,t,r){new n(e,r).to.equal(t)},Throw:function(e,t,r,o){new n(e,o).to.Throw(t,r)},exist:function(e,t){new n(e,t).to.exist},not:{}};return t.not.equal=function(e,t,r){new n(e,r).to.not.equal(t)},t.not.Throw=function(e,t,r,o){new n(e,o).to.not.Throw(t,r)},t.not.exist=function(e,t){new n(e,t).to.not.exist},t.throw=t.Throw,t.not.throw=t.not.Throw,t}e.should=r,e.Should=r}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){
/*!
   * Chai dependencies.
   */
var n=e.Assertion,r=t.flag,o=e.assert=function(t,r){new n(null,null,e.assert,!0).assert(t,r,"[ negation message unavailable ]")};
/*!
   * Module export.
   */o.fail=function(t,n,r,s){throw arguments.length<2&&(r=t,t=void 0),r=r||"assert.fail()",new e.AssertionError(r,{actual:t,expected:n,operator:s},o.fail)},o.isOk=function(e,t){new n(e,t,o.isOk,!0).is.ok},o.isNotOk=function(e,t){new n(e,t,o.isNotOk,!0).is.not.ok},o.equal=function(e,t,s){var i=new n(e,s,o.equal,!0);i.assert(t==r(i,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e,!0)},o.notEqual=function(e,t,s){var i=new n(e,s,o.notEqual,!0);i.assert(t!=r(i,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e,!0)},o.strictEqual=function(e,t,r){new n(e,r,o.strictEqual,!0).to.equal(t)},o.notStrictEqual=function(e,t,r){new n(e,r,o.notStrictEqual,!0).to.not.equal(t)},o.deepEqual=o.deepStrictEqual=function(e,t,r){new n(e,r,o.deepEqual,!0).to.eql(t)},o.notDeepEqual=function(e,t,r){new n(e,r,o.notDeepEqual,!0).to.not.eql(t)},o.isAbove=function(e,t,r){new n(e,r,o.isAbove,!0).to.be.above(t)},o.isAtLeast=function(e,t,r){new n(e,r,o.isAtLeast,!0).to.be.least(t)},o.isBelow=function(e,t,r){new n(e,r,o.isBelow,!0).to.be.below(t)},o.isAtMost=function(e,t,r){new n(e,r,o.isAtMost,!0).to.be.most(t)},o.isTrue=function(e,t){new n(e,t,o.isTrue,!0).is.true},o.isNotTrue=function(e,t){new n(e,t,o.isNotTrue,!0).to.not.equal(!0)},o.isFalse=function(e,t){new n(e,t,o.isFalse,!0).is.false},o.isNotFalse=function(e,t){new n(e,t,o.isNotFalse,!0).to.not.equal(!1)},o.isNull=function(e,t){new n(e,t,o.isNull,!0).to.equal(null)},o.isNotNull=function(e,t){new n(e,t,o.isNotNull,!0).to.not.equal(null)},o.isNaN=function(e,t){new n(e,t,o.isNaN,!0).to.be.NaN},o.isNotNaN=function(e,t){new n(e,t,o.isNotNaN,!0).not.to.be.NaN},o.exists=function(e,t){new n(e,t,o.exists,!0).to.exist},o.notExists=function(e,t){new n(e,t,o.notExists,!0).to.not.exist},o.isUndefined=function(e,t){new n(e,t,o.isUndefined,!0).to.equal(void 0)},o.isDefined=function(e,t){new n(e,t,o.isDefined,!0).to.not.equal(void 0)},o.isFunction=function(e,t){new n(e,t,o.isFunction,!0).to.be.a("function")},o.isNotFunction=function(e,t){new n(e,t,o.isNotFunction,!0).to.not.be.a("function")},o.isObject=function(e,t){new n(e,t,o.isObject,!0).to.be.a("object")},o.isNotObject=function(e,t){new n(e,t,o.isNotObject,!0).to.not.be.a("object")},o.isArray=function(e,t){new n(e,t,o.isArray,!0).to.be.an("array")},o.isNotArray=function(e,t){new n(e,t,o.isNotArray,!0).to.not.be.an("array")},o.isString=function(e,t){new n(e,t,o.isString,!0).to.be.a("string")},o.isNotString=function(e,t){new n(e,t,o.isNotString,!0).to.not.be.a("string")},o.isNumber=function(e,t){new n(e,t,o.isNumber,!0).to.be.a("number")},o.isNotNumber=function(e,t){new n(e,t,o.isNotNumber,!0).to.not.be.a("number")},o.isFinite=function(e,t){new n(e,t,o.isFinite,!0).to.be.finite},o.isBoolean=function(e,t){new n(e,t,o.isBoolean,!0).to.be.a("boolean")},o.isNotBoolean=function(e,t){new n(e,t,o.isNotBoolean,!0).to.not.be.a("boolean")},o.typeOf=function(e,t,r){new n(e,r,o.typeOf,!0).to.be.a(t)},o.notTypeOf=function(e,t,r){new n(e,r,o.notTypeOf,!0).to.not.be.a(t)},o.instanceOf=function(e,t,r){new n(e,r,o.instanceOf,!0).to.be.instanceOf(t)},o.notInstanceOf=function(e,t,r){new n(e,r,o.notInstanceOf,!0).to.not.be.instanceOf(t)},o.include=function(e,t,r){new n(e,r,o.include,!0).include(t)},o.notInclude=function(e,t,r){new n(e,r,o.notInclude,!0).not.include(t)},o.deepInclude=function(e,t,r){new n(e,r,o.deepInclude,!0).deep.include(t)},o.notDeepInclude=function(e,t,r){new n(e,r,o.notDeepInclude,!0).not.deep.include(t)},o.nestedInclude=function(e,t,r){new n(e,r,o.nestedInclude,!0).nested.include(t)},o.notNestedInclude=function(e,t,r){new n(e,r,o.notNestedInclude,!0).not.nested.include(t)},o.deepNestedInclude=function(e,t,r){new n(e,r,o.deepNestedInclude,!0).deep.nested.include(t)},o.notDeepNestedInclude=function(e,t,r){new n(e,r,o.notDeepNestedInclude,!0).not.deep.nested.include(t)},o.ownInclude=function(e,t,r){new n(e,r,o.ownInclude,!0).own.include(t)},o.notOwnInclude=function(e,t,r){new n(e,r,o.notOwnInclude,!0).not.own.include(t)},o.deepOwnInclude=function(e,t,r){new n(e,r,o.deepOwnInclude,!0).deep.own.include(t)},o.notDeepOwnInclude=function(e,t,r){new n(e,r,o.notDeepOwnInclude,!0).not.deep.own.include(t)},o.match=function(e,t,r){new n(e,r,o.match,!0).to.match(t)},o.notMatch=function(e,t,r){new n(e,r,o.notMatch,!0).to.not.match(t)},o.property=function(e,t,r){new n(e,r,o.property,!0).to.have.property(t)},o.notProperty=function(e,t,r){new n(e,r,o.notProperty,!0).to.not.have.property(t)},o.propertyVal=function(e,t,r,s){new n(e,s,o.propertyVal,!0).to.have.property(t,r)},o.notPropertyVal=function(e,t,r,s){new n(e,s,o.notPropertyVal,!0).to.not.have.property(t,r)},o.deepPropertyVal=function(e,t,r,s){new n(e,s,o.deepPropertyVal,!0).to.have.deep.property(t,r)},o.notDeepPropertyVal=function(e,t,r,s){new n(e,s,o.notDeepPropertyVal,!0).to.not.have.deep.property(t,r)},o.ownProperty=function(e,t,r){new n(e,r,o.ownProperty,!0).to.have.own.property(t)},o.notOwnProperty=function(e,t,r){new n(e,r,o.notOwnProperty,!0).to.not.have.own.property(t)},o.ownPropertyVal=function(e,t,r,s){new n(e,s,o.ownPropertyVal,!0).to.have.own.property(t,r)},o.notOwnPropertyVal=function(e,t,r,s){new n(e,s,o.notOwnPropertyVal,!0).to.not.have.own.property(t,r)},o.deepOwnPropertyVal=function(e,t,r,s){new n(e,s,o.deepOwnPropertyVal,!0).to.have.deep.own.property(t,r)},o.notDeepOwnPropertyVal=function(e,t,r,s){new n(e,s,o.notDeepOwnPropertyVal,!0).to.not.have.deep.own.property(t,r)},o.nestedProperty=function(e,t,r){new n(e,r,o.nestedProperty,!0).to.have.nested.property(t)},o.notNestedProperty=function(e,t,r){new n(e,r,o.notNestedProperty,!0).to.not.have.nested.property(t)},o.nestedPropertyVal=function(e,t,r,s){new n(e,s,o.nestedPropertyVal,!0).to.have.nested.property(t,r)},o.notNestedPropertyVal=function(e,t,r,s){new n(e,s,o.notNestedPropertyVal,!0).to.not.have.nested.property(t,r)},o.deepNestedPropertyVal=function(e,t,r,s){new n(e,s,o.deepNestedPropertyVal,!0).to.have.deep.nested.property(t,r)},o.notDeepNestedPropertyVal=function(e,t,r,s){new n(e,s,o.notDeepNestedPropertyVal,!0).to.not.have.deep.nested.property(t,r)},o.lengthOf=function(e,t,r){new n(e,r,o.lengthOf,!0).to.have.lengthOf(t)},o.hasAnyKeys=function(e,t,r){new n(e,r,o.hasAnyKeys,!0).to.have.any.keys(t)},o.hasAllKeys=function(e,t,r){new n(e,r,o.hasAllKeys,!0).to.have.all.keys(t)},o.containsAllKeys=function(e,t,r){new n(e,r,o.containsAllKeys,!0).to.contain.all.keys(t)},o.doesNotHaveAnyKeys=function(e,t,r){new n(e,r,o.doesNotHaveAnyKeys,!0).to.not.have.any.keys(t)},o.doesNotHaveAllKeys=function(e,t,r){new n(e,r,o.doesNotHaveAllKeys,!0).to.not.have.all.keys(t)},o.hasAnyDeepKeys=function(e,t,r){new n(e,r,o.hasAnyDeepKeys,!0).to.have.any.deep.keys(t)},o.hasAllDeepKeys=function(e,t,r){new n(e,r,o.hasAllDeepKeys,!0).to.have.all.deep.keys(t)},o.containsAllDeepKeys=function(e,t,r){new n(e,r,o.containsAllDeepKeys,!0).to.contain.all.deep.keys(t)},o.doesNotHaveAnyDeepKeys=function(e,t,r){new n(e,r,o.doesNotHaveAnyDeepKeys,!0).to.not.have.any.deep.keys(t)},o.doesNotHaveAllDeepKeys=function(e,t,r){new n(e,r,o.doesNotHaveAllDeepKeys,!0).to.not.have.all.deep.keys(t)},o.throws=function(e,t,s,i){("string"==typeof t||t instanceof RegExp)&&(s=t,t=null);var a=new n(e,i,o.throws,!0).to.throw(t,s);return r(a,"object")},o.doesNotThrow=function(e,t,r,s){("string"==typeof t||t instanceof RegExp)&&(r=t,t=null),new n(e,s,o.doesNotThrow,!0).to.not.throw(t,r)},o.operator=function(s,i,a,c){var u;switch(i){case"==":u=s==a;break;case"===":u=s===a;break;case">":u=s>a;break;case">=":u=s>=a;break;case"<":u=s<a;break;case"<=":u=s<=a;break;case"!=":u=s!=a;break;case"!==":u=s!==a;break;default:throw c=c?c+": ":c,new e.AssertionError(c+'Invalid operator "'+i+'"',void 0,o.operator)}var h=new n(u,c,o.operator,!0);h.assert(!0===r(h,"object"),"expected "+t.inspect(s)+" to be "+i+" "+t.inspect(a),"expected "+t.inspect(s)+" to not be "+i+" "+t.inspect(a))},o.closeTo=function(e,t,r,s){new n(e,s,o.closeTo,!0).to.be.closeTo(t,r)},o.approximately=function(e,t,r,s){new n(e,s,o.approximately,!0).to.be.approximately(t,r)},o.sameMembers=function(e,t,r){new n(e,r,o.sameMembers,!0).to.have.same.members(t)},o.notSameMembers=function(e,t,r){new n(e,r,o.notSameMembers,!0).to.not.have.same.members(t)},o.sameDeepMembers=function(e,t,r){new n(e,r,o.sameDeepMembers,!0).to.have.same.deep.members(t)},o.notSameDeepMembers=function(e,t,r){new n(e,r,o.notSameDeepMembers,!0).to.not.have.same.deep.members(t)},o.sameOrderedMembers=function(e,t,r){new n(e,r,o.sameOrderedMembers,!0).to.have.same.ordered.members(t)},o.notSameOrderedMembers=function(e,t,r){new n(e,r,o.notSameOrderedMembers,!0).to.not.have.same.ordered.members(t)},o.sameDeepOrderedMembers=function(e,t,r){new n(e,r,o.sameDeepOrderedMembers,!0).to.have.same.deep.ordered.members(t)},o.notSameDeepOrderedMembers=function(e,t,r){new n(e,r,o.notSameDeepOrderedMembers,!0).to.not.have.same.deep.ordered.members(t)},o.includeMembers=function(e,t,r){new n(e,r,o.includeMembers,!0).to.include.members(t)},o.notIncludeMembers=function(e,t,r){new n(e,r,o.notIncludeMembers,!0).to.not.include.members(t)},o.includeDeepMembers=function(e,t,r){new n(e,r,o.includeDeepMembers,!0).to.include.deep.members(t)},o.notIncludeDeepMembers=function(e,t,r){new n(e,r,o.notIncludeDeepMembers,!0).to.not.include.deep.members(t)},o.includeOrderedMembers=function(e,t,r){new n(e,r,o.includeOrderedMembers,!0).to.include.ordered.members(t)},o.notIncludeOrderedMembers=function(e,t,r){new n(e,r,o.notIncludeOrderedMembers,!0).to.not.include.ordered.members(t)},o.includeDeepOrderedMembers=function(e,t,r){new n(e,r,o.includeDeepOrderedMembers,!0).to.include.deep.ordered.members(t)},o.notIncludeDeepOrderedMembers=function(e,t,r){new n(e,r,o.notIncludeDeepOrderedMembers,!0).to.not.include.deep.ordered.members(t)},o.oneOf=function(e,t,r){new n(e,r,o.oneOf,!0).to.be.oneOf(t)},o.changes=function(e,t,r,s){3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.changes,!0).to.change(t,r)},o.changesBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.changesBy,!0).to.change(t,r).by(s)},o.doesNotChange=function(e,t,r,s){return 3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.doesNotChange,!0).to.not.change(t,r)},o.changesButNotBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.changesButNotBy,!0).to.change(t,r).but.not.by(s)},o.increases=function(e,t,r,s){return 3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.increases,!0).to.increase(t,r)},o.increasesBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.increasesBy,!0).to.increase(t,r).by(s)},o.doesNotIncrease=function(e,t,r,s){return 3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.doesNotIncrease,!0).to.not.increase(t,r)},o.increasesButNotBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.increasesButNotBy,!0).to.increase(t,r).but.not.by(s)},o.decreases=function(e,t,r,s){return 3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.decreases,!0).to.decrease(t,r)},o.decreasesBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.decreasesBy,!0).to.decrease(t,r).by(s)},o.doesNotDecrease=function(e,t,r,s){return 3===arguments.length&&"function"==typeof t&&(s=r,r=null),new n(e,s,o.doesNotDecrease,!0).to.not.decrease(t,r)},o.doesNotDecreaseBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);return new n(e,i,o.doesNotDecreaseBy,!0).to.not.decrease(t,r).by(s)},o.decreasesButNotBy=function(e,t,r,s,i){if(4===arguments.length&&"function"==typeof t){var a=s;s=r,i=a}else 3===arguments.length&&(s=r,r=null);new n(e,i,o.decreasesButNotBy,!0).to.decrease(t,r).but.not.by(s)}
/*!
   * ### .ifError(object)
   *
   * Asserts if value is not a false value, and throws if it is a true value.
   * This is added to allow for chai to be a drop-in replacement for Node's
   * assert class.
   *
   *     var err = new Error('I am a custom error');
   *     assert.ifError(err); // Rethrows err!
   *
   * @name ifError
   * @param {Object} object
   * @namespace Assert
   * @api public
   */,o.ifError=function(e){if(e)throw e},o.isExtensible=function(e,t){new n(e,t,o.isExtensible,!0).to.be.extensible},o.isNotExtensible=function(e,t){new n(e,t,o.isNotExtensible,!0).to.not.be.extensible},o.isSealed=function(e,t){new n(e,t,o.isSealed,!0).to.be.sealed},o.isNotSealed=function(e,t){new n(e,t,o.isNotSealed,!0).to.not.be.sealed},o.isFrozen=function(e,t){new n(e,t,o.isFrozen,!0).to.be.frozen},o.isNotFrozen=function(e,t){new n(e,t,o.isNotFrozen,!0).to.not.be.frozen},o.isEmpty=function(e,t){new n(e,t,o.isEmpty,!0).to.be.empty},o.isNotEmpty=function(e,t){new n(e,t,o.isNotEmpty,!0).to.not.be.empty},
/*!
   * Aliases.
   */
function e(t,n){return o[n]=o[t],e}("isOk","ok")("isNotOk","notOk")("throws","throw")("throws","Throw")("isExtensible","extensible")("isNotExtensible","notExtensible")("isSealed","sealed")("isNotSealed","notSealed")("isFrozen","frozen")("isNotFrozen","notFrozen")("isEmpty","empty")("isNotEmpty","notEmpty")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1)),i=r(n(25)),a=r(n(16));describe("Ketting",()=>{it("should return a HTML representor when requested",()=>{const e=new s.default("https://example.org/").getRepresentor("text/html");o.expect(e).to.eql(a.default)}),it("should return a Hal representor when requested",()=>{const e=new s.default("https://example.org").getRepresentor("application/hal+json");o.expect(e).to.eql(i.default)}),it("should throw an error when an unknown representor was requested ",()=>{const e=new s.default("https://example.org");o.expect(()=>e.getRepresentor("text/plain")).to.throw(Error)}),it("should throw an error an a representor was incorrecly configured ",()=>{const e=new s.default("https://example.org");e.contentTypes.push({mime:"text/plain",representor:"bla-bla"}),o.expect(()=>e.getRepresentor("text/plain")).to.throw(Error)})})},function(e,t,n){e.exports=function(){function e(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,r){var o={uriTemplate:function(){var e,t,n;n=s,e=[],null===(t=g())&&(t=h());for(;null!==t;)e.push(t),null===(t=g())&&(t=h());null!==e&&(e=function(e,t){return new v(t)}(0,e));null===e&&(s=n);return e},expression:h,op:l,pathExpression:function(){var e;"{/"===t.substr(s,2)?(e="{/",s+=2):(e=null,0===i&&u('"{/"'));return e},paramList:f,param:p,cut:d,listMarker:y,substr:w,nonexpression:g,extension:b};if(void 0!==r){if(void 0===o[r])throw new Error("Invalid rule name: "+e(r)+".")}else r="uriTemplate";var s=0,i=0,a=0,c=[];function u(e){s<a||(s>a&&(a=s,c=[]),c.push(e))}function h(){var e,n,r,o,a,c;return a=s,c=s,123===t.charCodeAt(s)?(e="{",s++):(e=null,0===i&&u('"{"')),null!==e&&null!==(n=l())&&null!==(r=f())?(125===t.charCodeAt(s)?(o="}",s++):(o=null,0===i&&u('"}"')),null!==o?e=[e,n,r,o]:(e=null,s=c)):(e=null,s=c),null!==e&&(e=function(e,t,n){return x(t,n)}(0,e[1],e[2])),null===e&&(s=a),e}function l(){var e;return/^[\/;:.?&+#]/.test(t.charAt(s))?(e=t.charAt(s),s++):(e=null,0===i&&u("[\\/;:.?&+#]")),null===e&&(e=""),e}function f(){var e,n,r,o,a,c,h,l;if(a=s,c=s,null!==(e=p())){for(n=[],h=s,l=s,44===t.charCodeAt(s)?(r=",",s++):(r=null,0===i&&u('","')),null!==r&&null!==(o=p())?r=[r,o]:(r=null,s=l),null!==r&&(r=r[1]),null===r&&(s=h);null!==r;)n.push(r),h=s,l=s,44===t.charCodeAt(s)?(r=",",s++):(r=null,0===i&&u('","')),null!==r&&null!==(o=p())?r=[r,o]:(r=null,s=l),null!==r&&(r=r[1]),null===r&&(s=h);null!==n?e=[e,n]:(e=null,s=c)}else e=null,s=c;return null!==e&&(e=function(e,t,n){return n.unshift(t),n}(0,e[0],e[1])),null===e&&(s=a),e}function p(){var e,n,r,o,a;for(o=s,a=s,e=[],/^[a-zA-Z0-9_.%]/.test(t.charAt(s))?(n=t.charAt(s),s++):(n=null,0===i&&u("[a-zA-Z0-9_.%]"));null!==n;)e.push(n),/^[a-zA-Z0-9_.%]/.test(t.charAt(s))?(n=t.charAt(s),s++):(n=null,0===i&&u("[a-zA-Z0-9_.%]"));return null!==e?(null===(n=d())&&(n=y()),null!==(n=null!==n?n:"")&&null!==(r=null!==(r=b())?r:"")?e=[e,n,r]:(e=null,s=a)):(e=null,s=a),null!==e&&(e=function(e,t,n,r){return n=n||{},{name:t.join(""),explode:n.listMarker,cut:n.cut,extended:r}}(0,e[0],e[1],e[2])),null===e&&(s=o),e}function d(){var e,t;return t=s,null!==(e=w())&&(e={cut:e}),null===e&&(s=t),e}function y(){var e,n;return n=s,42===t.charCodeAt(s)?(e="*",s++):(e=null,0===i&&u('"*"')),null!==e&&(e={listMarker:e}),null===e&&(s=n),e}function w(){var e,n,r,o,a;if(o=s,a=s,58===t.charCodeAt(s)?(e=":",s++):(e=null,0===i&&u('":"')),null!==e){if(/^[0-9]/.test(t.charAt(s))?(r=t.charAt(s),s++):(r=null,0===i&&u("[0-9]")),null!==r)for(n=[];null!==r;)n.push(r),/^[0-9]/.test(t.charAt(s))?(r=t.charAt(s),s++):(r=null,0===i&&u("[0-9]"));else n=null;null!==n?e=[e,n]:(e=null,s=a)}else e=null,s=a;return null!==e&&(e=function(e,t){return parseInt(t.join(""))}(0,e[1])),null===e&&(s=o),e}function g(){var e,n,r;if(r=s,/^[^{]/.test(t.charAt(s))?(n=t.charAt(s),s++):(n=null,0===i&&u("[^{]")),null!==n)for(e=[];null!==n;)e.push(n),/^[^{]/.test(t.charAt(s))?(n=t.charAt(s),s++):(n=null,0===i&&u("[^{]"));else e=null;return null!==e&&(e=e.join("")),null===e&&(s=r),e}function b(){var e,n,r,o,a;if(o=s,a=s,40===t.charCodeAt(s)?(e="(",s++):(e=null,0===i&&u('"("')),null!==e){if(/^[^)]/.test(t.charAt(s))?(r=t.charAt(s),s++):(r=null,0===i&&u("[^)]")),null!==r)for(n=[];null!==r;)n.push(r),/^[^)]/.test(t.charAt(s))?(r=t.charAt(s),s++):(r=null,0===i&&u("[^)]"));else n=null;null!==n?(41===t.charCodeAt(s)?(r=")",s++):(r=null,0===i&&u('")"')),null!==r?e=[e,n,r]:(e=null,s=a)):(e=null,s=a)}else e=null,s=a;return null!==e&&(e=e[1].join("")),null===e&&(s=o),e}var m=n(58),v=m.Template,x=m.expression,j=o[r]();if(null===j||s!==t.length){var _=Math.max(s,a),k=_<t.length?t.charAt(_):null,O=function(){for(var e=1,n=1,r=!1,o=0;o<Math.max(s,a);o++){var i=t.charAt(o);"\n"===i?(r||e++,n=1,r=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(e++,n=1,r=!0):(n++,r=!1)}return{line:e,column:n}}();throw new this.SyntaxError(function(e){e.sort();for(var t=null,n=[],r=0;r<e.length;r++)e[r]!==t&&(n.push(e[r]),t=e[r]);return n}(c),k,_,O.line,O.column)}return j},toSource:function(){return this._source},SyntaxError:function(t,n,r,o,s){this.name="SyntaxError",this.expected=t,this.found=n,this.message=function(t,n){var r;switch(t.length){case 0:r="end of input";break;case 1:r=t[0];break;default:r=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return"Expected "+r+" but "+(n?e(n):"end of input")+" found."}(t,n),this.offset=r,this.line=o,this.column=s}};return t.SyntaxError.prototype=Error.prototype,t}()},function(e,t,n){(function(){var t,r,o,s,i,a,c,u,h,l,f,p=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty,y=function(e,t){for(var n in t)d.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};f=n(59),l=l=function(){function e(e){var t,n=this;this.expressions=[],this.prefix="string"==typeof e[0]?e.shift():"",t=0,e.forEach(function(e){switch(typeof e){case"object":return n.expressions[t++]=e;case"string":return n.expressions[t-1].suffix=e}})}return e.prototype.expand=function(e){return this.prefix+this.expressions.map(function(t){return t.expand(e)}).join("")},e.prototype.toString=function(){return this.prefix+this.expressions.join("")},e.prototype.toJSON=function(){return this.toString()},e}(),h=function(){var e;function t(e){this.params=e,this.explodeObject=p(this.explodeObject,this),this.explodeArray=p(this.explodeArray,this),this._expandPair=p(this._expandPair,this),this.stringifySingle=p(this.stringifySingle,this),this.encode=p(this.encode,this),null==this.params&&(this.params=[]),this.suffix=""}return t.prototype.first="",t.prototype.sep=",",t.prototype.named=!1,t.prototype.empty="",t.prototype.allow="U",t.prototype.encode=function(e){return f[this.allow](e)},t.prototype.stringifySingle=function(e,t){var n,r,o;if("string"===(r=typeof t)||"boolean"===r||"number"===r)return t=t.toString(),this.encode(t.substring(0,e.cut||t.length));if(Array.isArray(t)){if(e.cut)throw new Error("Prefixed Values do not support lists. Check "+e.name);return t.map(this.encode).join(",")}if(e.cut)throw new Error("Prefixed Values do not support maps. Check "+e.name);return function(){var e;for(n in e=[],t)o=t[n],e.push([n,o].map(this.encode).join(","));return e}.call(this).join(",")},t.prototype.expand=function(t){var n,r,o=this;return(r=(n=e(this.params,t)).map(function(e){return o._expandPair.apply(o,e)}).join(this.sep))?this.first+r+this.suffix:this.empty&&n.length?this.empty+this.suffix:this.suffix},e=function(e,t){return e.map(function(e){return[e,t[e.name]]}).filter(function(e){var t,n;switch(typeof(n=e[1])){case"undefined":return!1;case"object":for(t in Array.isArray(n)&&n.length,n)if(n[t])return!0;return!1;default:return!0}})},t.prototype._expandPair=function(e,t){return e.name,e.explode?Array.isArray(t)?this.explodeArray(e,t):"string"==typeof t?this.stringifySingle(e,t):this.explodeObject(t):this.stringifySingle(e,t)},t.prototype.explodeArray=function(e,t){return t.map(this.encode).join(this.sep)},t.prototype.explodeObject=function(e){var t,n,r,o,s,i;for(t in n=[],e)if(r=e[t],t=this.encode(t),Array.isArray(r))for(s=0,i=r.length;s<i;s++)o=r[s],n.push([t,this.encode(o)]);else n.push([t,this.encode(r)]);return n.map(function(e){return e.join("=")}).join(this.sep)},t.prototype.toString=function(){var e;return e=this.params.map(function(e){return e.name+e.explode}).join(","),"{"+this.first+e+"}"+this.suffix},t.prototype.toJSON=function(){return this.toString()},t}(),i=function(e){function t(){return this.explodeArray=p(this.explodeArray,this),this.stringifySingle=p(this.stringifySingle,this),t.__super__.constructor.apply(this,arguments)}return y(t,h),t.prototype.stringifySingle=function(e,n){return n=(n=t.__super__.stringifySingle.apply(this,arguments))?"="+n:this.empty,""+e.name+n},t.prototype.explodeArray=function(e,t){var n=this;return t.map(function(t){return e.name+"="+n.encode(t)}).join(this.sep)},t}(),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,h),t.prototype.encode=function(e){return f["U+R"](e)},t.prototype.toString=function(){return"{+"+t.__super__.toString.apply(this,arguments).substring(1)},t}(),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,h),t.prototype.first="#",t.prototype.empty="#",t.prototype.encode=function(e){return f["U+R"](e)},t}(),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,h),t.prototype.first=".",t.prototype.sep=".",t.prototype.empty=".",t}(),c=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,h),t.prototype.first="/",t.prototype.sep="/",t}(),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,i),t.prototype.first=";",t.prototype.sep=";",t}(),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,i),t.prototype.first="?",t.prototype.sep="&",t.prototype.empty="=",t}(),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,r),t.prototype.first="&",t}(),e.exports={Template:l,SimpleExpression:h,NamedExpression:i,ReservedExpression:u,FragmentExpression:o,LabelExpression:s,PathSegmentExpression:c,PathParamExpression:a,FormStartExpression:r,FormContinuationExpression:t,expression:function(e,n){return new(function(){switch(e){case"":return h;case"+":return u;case"#":return o;case".":return s;case"/":return c;case";":return a;case"?":return r;case"&":return t}}())(n)}}}).call(this)},function(e,t,n){(function(){var e;e=n(60),t.U=e(/[^\w~.-]/g),t["U+R"]=e(/[^\w.~:\/\?#\[\]@!\$&'()*+,;=%-]|%(?!\d\d)/g)}).call(this)},function(e,t){e.exports=function(e){return e=e||/\W/g,function(t){return(t=String(t)).replace(e,function(e){var t=e[0].charCodeAt(0),n=[];return t<128?n.push(t):128<=t&&t<2048?(n.push(t>>6|192),n.push(63&t|128)):(n.push(t>>12|224),n.push(t>>6&63|128),n.push(63&t|128)),n.map(function(e){return"%"+e.toString(16).toUpperCase()}).join("")})}}},function(e,t,n){(function(t){var r=n(17),o=n(65);function s(e){if(!(this instanceof s))return new s(e);this.refs=[]}s.pattern=/(?:\<([^\>]+)\>)((\s*;\s*([a-z\*]+)=(("[^"]+")|('[^']+')|([^\,\;]+)))*)(\s*,\s*|$)/gi,s.attrPattern=/([a-z\*]+)=(?:(?:"([^"]+)")|(?:'([^']+)')|([^\,\;]+))/gi,s.isCompatibleEncoding=function(e){return/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i.test(e)},s.formatExtendedAttribute=function(e,n){var o=(n.encoding||"utf-8").toUpperCase();return e+"="+o+"'"+(n.language||"en")+"'"+(t.isBuffer(n.value)&&s.isCompatibleEncoding(o)?n.value.toString(o):t.isBuffer(n.value)?n.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):r.escape(n.value))},s.formatAttribute=function(e,t){return/\*$/.test(e)||"string"!=typeof t?s.formatExtendedAttribute(e,t):(/[^a-z]/i.test(t)&&(t='"'+(t=r.escape(t).replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"))+'"'),e+"="+t)},s.parseExtendedValue=function(e){var t=/([^']+)?(?:'([^']+)')?(.+)/.exec(e);return{language:t[2].toLowerCase(),encoding:s.isCompatibleEncoding(t[1])?null:t[1].toLowerCase(),value:s.isCompatibleEncoding(t[1])?r.unescape(t[3]):t[3]}},s.setAttr=function(e,t,n){return"rel"===t&&null!=e[t]?e:(Array.isArray(e[t])?e[t].push(n):null!=e[t]?e[t]=[e[t],n]:e[t]=n,e)},s.parseParams=function(e,t){var n={},r=/(.+)\?(.+)/gi.exec(t);if(!r)return e;r=r[2].split("&");for(var o=0;o<r.length;o++){var i=r[o].split("=");n[i[0]]=i[1]}return s.setAttr(e,"params",n),e},s.parseAttrs=function(e,t){var n=null,o="",i="",a="",c=/<(.*)>;\s*(.*)/gi.exec(t);for(c&&(a=c[2],e=s.parseParams(e,c[1]));n=s.attrPattern.exec(a);)o=n[1].toLowerCase(),i=n[4]||n[3]||n[2],/\*$/.test(o)?s.setAttr(e,o,s.parseExtendedValue(i)):/%/.test(i)?s.setAttr(e,o,r.unescape(i)):s.setAttr(e,o,i);return e},s.parse=function(e){return(new s).parse(e)},s.prototype={constructor:s,rel:function(e){for(var t=[],n=0;n<this.refs.length;n++)this.refs[n].rel===e&&t.push(this.refs[n]);return t},get:function(e,t){e=e.toLowerCase();for(var n=[],r=0;r<this.refs.length;r++)this.refs[r][e]===t&&n.push(this.refs[r]);return n},set:function(e){return this.refs.push(e),this},has:function(e,t){return null!=this.get(e,t)},parse:function(e){e=o(e).replace(/\r?\n[\x20\x09]+/g,"");for(var t=null;t=s.pattern.exec(e);){var n=s.parseAttrs({uri:t[1]},t[0]);this.refs.push(n)}return this},toString:function(){for(var e=[],t="",n=null,r=0;r<this.refs.length;r++)n=this.refs[r],t=Object.keys(this.refs[r]).reduce(function(e,t){return"uri"===t?e:e+"; "+s.formatAttribute(t,n[t])},"<"+n.uri+">"),e.push(t);return e.join(", ")}},e.exports=s}).call(this,n(27).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=u(e),r=n[0],i=n[1],a=new s(function(e,t,n){return 3*(t+n)/4-n}(0,r,i)),c=0,h=i>0?r-4:r,l=0;l<h;l+=4)t=o[e.charCodeAt(l)]<<18|o[e.charCodeAt(l+1)]<<12|o[e.charCodeAt(l+2)]<<6|o[e.charCodeAt(l+3)],a[c++]=t>>16&255,a[c++]=t>>8&255,a[c++]=255&t;2===i&&(t=o[e.charCodeAt(l)]<<2|o[e.charCodeAt(l+1)]>>4,a[c++]=255&t);1===i&&(t=o[e.charCodeAt(l)]<<10|o[e.charCodeAt(l+1)]<<4|o[e.charCodeAt(l+2)]>>2,a[c++]=t>>8&255,a[c++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,s=[],i=0,a=n-o;i<a;i+=16383)s.push(l(e,i,i+16383>a?a:i+16383));1===o?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return s.join("")};for(var r=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=i.length;a<c;++a)r[a]=i[a],o[i.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function l(e,t,n){for(var r,o=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(h(r));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var s,i,a=8*o-r-1,c=(1<<a)-1,u=c>>1,h=-7,l=n?o-1:0,f=n?-1:1,p=e[t+l];for(l+=f,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+e[t+l],l+=f,h-=8);for(i=s&(1<<-h)-1,s>>=-h,h+=r;h>0;i=256*i+e[t+l],l+=f,h-=8);if(0===s)s=1-u;else{if(s===c)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),s-=u}return(p?-1:1)*i*Math.pow(2,s-r)},t.write=function(e,t,n,r,o,s){var i,a,c,u=8*s-o-1,h=(1<<u)-1,l=h>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),(t+=i+l>=1?f/c:f*Math.pow(2,1-l))*c>=2&&(i++,c/=2),i+l>=h?(a=0,i=h):i+l>=1?(a=(t*c-1)*Math.pow(2,o),i+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;e[n+p]=255&a,p+=d,a/=256,o-=8);for(i=i<<o|a,u+=o;u>0;e[n+p]=255&i,p+=d,i/=256,u-=8);e[n+p-d]|=128*y}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encode=function(e){return btoa(e)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(68));n(12);t.OAuth2Helper=class{constructor(e){this.client=new o.default(e.client),this.token=null,this.owner=e.owner}async fetch(e){const t=await this.getToken();e.headers.set("Authorization","Bearer "+t.accessToken);const n=await fetch(e);return 401!==n.status?n:(await this.refreshToken(),e.headers.set("Authorization","Bearer "+this.token.accessToken),fetch(e))}async getToken(){return this.token?this.token:this.refreshToken()}async refreshToken(){return this.token&&this.token.refreshToken?(this.token=await this.token.refresh(),this.token):this.owner?(this.token=await this.client.owner.getToken(this.owner.userName,this.owner.password),this.token):(this.token=await this.client.credentials.getToken(),this.token)}}},function(e,t,n){var r=n(69).Buffer,o=n(17),s=n(70),i=n(74),a="function"==typeof r?function(e){return new r(e).toString("base64")}:window.btoa;e.exports=g;var c={Accept:"application/json, application/x-www-form-urlencoded","Content-Type":"application/x-www-form-urlencoded"},u={invalid_request:["The request is missing a required parameter, includes an","invalid parameter value, includes a parameter more than","once, or is otherwise malformed."].join(" "),invalid_client:["Client authentication failed (e.g., unknown client, no","client authentication included, or unsupported","authentication method)."].join(" "),invalid_grant:["The provided authorization grant (e.g., authorization","code, resource owner credentials) or refresh token is","invalid, expired, revoked, does not match the redirection","URI used in the authorization request, or was issued to","another client."].join(" "),unauthorized_client:["The client is not authorized to request an authorization","code using this method."].join(" "),unsupported_grant_type:["The authorization grant type is not supported by the","authorization server."].join(" "),access_denied:["The resource owner or authorization server denied the request."].join(" "),unsupported_response_type:["The authorization server does not support obtaining","an authorization code using this method."].join(" "),invalid_scope:["The requested scope is invalid, unknown, or malformed."].join(" "),server_error:["The authorization server encountered an unexpected","condition that prevented it from fulfilling the request.","(This error code is needed because a 500 Internal Server","Error HTTP status code cannot be returned to the client","via an HTTP redirect.)"].join(" "),temporarily_unavailable:["The authorization server is currently unable to handle","the request due to a temporary overloading or maintenance","of the server."].join(" ")};function h(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null==e[n])throw new TypeError('Expected "'+n+'" to exist')}}function l(e){var t=u[e.error]||e.error_description||e.error;if(t){var n=new Error(t);return n.body=e,n.code="EAUTH",n}}function f(e){return Array.isArray(e)?e.join(" "):y(e)}function p(e,t){return h(e,"clientId","authorizationUri"),e.authorizationUri+"?"+o.stringify(Object.assign({client_id:e.clientId,redirect_uri:e.redirectUri,scope:f(e.scopes),response_type:t,state:e.state},e.query))}function d(e,t){return"Basic "+a(y(e)+":"+y(t))}function y(e){return null==e?"":String(e)}function w(e,t){return{url:e.url,method:e.method,body:Object.assign({},e.body,t.body),query:Object.assign({},e.query,t.query),headers:Object.assign({},e.headers,t.headers)}}function g(e,t){this.options=e,this.request=t||i,this.code=new j(this),this.token=new v(this),this.owner=new m(this),this.credentials=new x(this),this.jwt=new _(this)}function b(e,t){this.client=e,this.data=t,this.tokenType=t.token_type&&t.token_type.toLowerCase(),this.accessToken=t.access_token,this.refreshToken=t.refresh_token,this.expiresIn(Number(t.expires_in))}function m(e){this.client=e}function v(e){this.client=e}function x(e){this.client=e}function j(e){this.client=e}function _(e){this.client=e}g.Token=b,g.prototype.createToken=function(e,t,n,r){var o=Object.assign({},r,"string"==typeof e?{access_token:e}:e,"string"==typeof t?{refresh_token:t}:t,"string"==typeof n?{token_type:n}:n);return new g.Token(this,o)},g.prototype._request=function(e){var t=e.url,n=o.stringify(e.body),r=o.stringify(e.query);return r&&(t+=(-1===t.indexOf("?")?"?":"&")+r),this.request(e.method,t,n,e.headers).then(function(e){var t=function(e){try{return JSON.parse(e)}catch(t){return o.parse(e)}}(e.body),n=l(t);if(n)return Promise.reject(n);if(e.status<200||e.status>=399){var r=new Error("HTTP status "+e.status);return r.status=e.status,r.body=e.body,r.code="ESTATUS",Promise.reject(r)}return t})},b.prototype.expiresIn=function(e){if("number"==typeof e)this.expires=new Date,this.expires.setSeconds(this.expires.getSeconds()+e);else{if(!(e instanceof Date))throw new TypeError("Unknown duration: "+e);this.expires=new Date(e.getTime())}return this.expires},b.prototype.sign=function(e){if(!this.accessToken)throw new Error("Unable to sign without access token");if(e.headers=e.headers||{},"bearer"===this.tokenType)e.headers.Authorization="Bearer "+this.accessToken;else{var t=e.url.split("#"),n="access_token="+this.accessToken,r=t[0].replace(/[?&]access_token=[^&#]/,""),o=t[1]?"#"+t[1]:"";e.url=r+(r.indexOf("?")>-1?"&":"?")+n+o,e.headers.Pragma="no-store",e.headers["Cache-Control"]="no-store"}return e},b.prototype.refresh=function(e){var t=this,n=Object.assign({},this.client.options,e);return this.refreshToken?this.client._request(w({url:n.accessTokenUri,method:"POST",headers:Object.assign({},c,{Authorization:d(n.clientId,n.clientSecret)}),body:{refresh_token:this.refreshToken,grant_type:"refresh_token"}},n)).then(function(e){return t.client.createToken(Object.assign({},t.data,e))}):Promise.reject(new Error("No refresh token"))},b.prototype.expired=function(){return Date.now()>this.expires.getTime()},m.prototype.getToken=function(e,t,n){var r=this,o=Object.assign({},this.client.options,n);return this.client._request(w({url:o.accessTokenUri,method:"POST",headers:Object.assign({},c,{Authorization:d(o.clientId,o.clientSecret)}),body:{scope:f(o.scopes),username:e,password:t,grant_type:"password"}},o)).then(function(e){return r.client.createToken(e)})},v.prototype.getUri=function(e){return p(Object.assign({},this.client.options,e),"token")},v.prototype.getToken=function(e,t){var n=Object.assign({},this.client.options,t),r="object"==typeof e?e:s.parse(e,!0),i=s.parse(n.redirectUri);if("string"==typeof r.pathname&&r.pathname!==i.pathname)return Promise.reject(new TypeError("Redirected path should match configured path, but got: "+r.pathname));if(!r.hash&&!r.search)return Promise.reject(new TypeError("Unable to process uri: "+e));var a=Object.assign({},"string"==typeof r.query?o.parse(r.query):r.query||{},"string"==typeof r.hash?o.parse(r.hash.substr(1)):r.hash||{}),c=l(a);return c?Promise.reject(c):null!=n.state&&a.state!==n.state?Promise.reject(new TypeError("Invalid state: "+a.state)):Promise.resolve(this.client.createToken(a))},x.prototype.getToken=function(e){var t=this,n=Object.assign({},this.client.options,e);return h(n,"clientId","clientSecret","accessTokenUri"),this.client._request(w({url:n.accessTokenUri,method:"POST",headers:Object.assign({},c,{Authorization:d(n.clientId,n.clientSecret)}),body:{scope:f(n.scopes),grant_type:"client_credentials"}},n)).then(function(e){return t.client.createToken(e)})},j.prototype.getUri=function(e){return p(Object.assign({},this.client.options,e),"code")},j.prototype.getToken=function(e,t){var n=this,r=Object.assign({},this.client.options,t);h(r,"clientId","accessTokenUri");var i="object"==typeof e?e:s.parse(e,!0);if("string"==typeof r.redirectUri&&"string"==typeof i.pathname&&i.pathname!==s.parse(r.redirectUri).pathname)return Promise.reject(new TypeError("Redirected path should match configured path, but got: "+i.pathname));if(!i.query)return Promise.reject(new TypeError("Unable to process uri: "+e));var a="string"==typeof i.query?o.parse(i.query):i.query||{},u=l(a);if(u)return Promise.reject(u);if(null!=r.state&&a.state!==r.state)return Promise.reject(new TypeError("Invalid state: "+a.state));if(!a.code)return Promise.reject(new TypeError("Missing code, unable to request token"));var f=Object.assign({},c),p={code:a.code,grant_type:"authorization_code",redirect_uri:r.redirectUri};return r.clientSecret?f.Authorization=d(r.clientId,r.clientSecret):p.client_id=r.clientId,this.client._request(w({url:r.accessTokenUri,method:"POST",headers:f,body:p},r)).then(function(e){return n.client.createToken(e)})},_.prototype.getToken=function(e,t){var n=this,r=Object.assign({},this.client.options,t),o=Object.assign({},c);return h(r,"accessTokenUri"),r.clientId&&(o.Authorization=d(r.clientId,r.clientSecret)),this.client._request(w({url:r.accessTokenUri,method:"POST",headers:o,body:{scope:f(r.scopes),grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e}},r)).then(function(e){return n.client.createToken(e)})}},function(e,t){},function(e,t,n){"use strict";var r=n(71),o=n(73);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=m,t.resolve=function(e,t){return m(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?m(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=m(e));return e instanceof s?e.format():s.prototype.format.call(e)},t.Url=s;var i=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(u),l=["%","/","?",";","#"].concat(h),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n(17);function m(e,t,n){if(e&&o.isObject(e)&&e instanceof s)return e;var r=new s;return r.parse(e,t,n),r}s.prototype.parse=function(e,t,n){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),a=-1!==s&&s<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var m=e=u.join(a);if(m=m.trim(),!n&&1===e.split("#").length){var v=c.exec(m);if(v)return this.path=m,this.href=m,this.pathname=v[1],v[2]?(this.search=v[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var x=i.exec(m);if(x){var j=(x=x[0]).toLowerCase();this.protocol=j,m=m.substr(x.length)}if(n||x||m.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===m.substr(0,2);!_||x&&w[x]||(m=m.substr(2),this.slashes=!0)}if(!w[x]&&(_||x&&!g[x])){for(var k,O,A=-1,T=0;T<f.length;T++){-1!==(E=m.indexOf(f[T]))&&(-1===A||E<A)&&(A=E)}-1!==(O=-1===A?m.lastIndexOf("@"):m.lastIndexOf("@",A))&&(k=m.slice(0,O),m=m.slice(O+1),this.auth=decodeURIComponent(k)),A=-1;for(T=0;T<l.length;T++){var E;-1!==(E=m.indexOf(l[T]))&&(-1===A||E<A)&&(A=E)}-1===A&&(A=m.length),this.host=m.slice(0,A),m=m.slice(A),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var S=this.hostname.split(/\./),M=(T=0,S.length);T<M;T++){var q=S[T];if(q&&!q.match(p)){for(var C="",N=0,R=q.length;N<R;N++)q.charCodeAt(N)>127?C+="x":C+=q[N];if(!C.match(p)){var D=S.slice(0,T),I=S.slice(T+1),U=q.match(d);U&&(D.push(U[1]),I.unshift(U[2])),I.length&&(m="/"+I.join(".")+m),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var B=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+B,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==m[0]&&(m="/"+m))}if(!y[j])for(T=0,M=h.length;T<M;T++){var H=h[T];if(-1!==m.indexOf(H)){var L=encodeURIComponent(H);L===H&&(L=escape(H)),m=m.split(H).join(L)}}var F=m.indexOf("#");-1!==F&&(this.hash=m.substr(F),m=m.slice(0,F));var Y=m.indexOf("?");if(-1!==Y?(this.search=m.substr(Y),this.query=m.substr(Y+1),t&&(this.query=b.parse(this.query)),m=m.slice(0,Y)):t&&(this.search="",this.query={}),m&&(this.pathname=m),g[j]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var V=this.search||"";this.path=B+V}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",s=!1,i="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(i=b.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+s+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(a=a.replace("#","%23"))+r},s.prototype.resolve=function(e){return this.resolveObject(m(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(o.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var n=new s,r=Object.keys(this),i=0;i<r.length;i++){var a=r[i];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var h=c[u];"protocol"!==h&&(n[h]=e[h])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!g[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var p=l[f];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||w[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var y=n.pathname||"",b=n.search||"";n.path=y+b}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=v||m||n.host&&e.pathname,j=x,_=n.pathname&&n.pathname.split("/")||[],k=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(k&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),x=x&&(""===d[0]||""===_[0])),v)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=d;else if(d.length)_||(_=[]),_.pop(),_=_.concat(d),n.search=e.search,n.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(k)n.hostname=n.host=_.shift(),(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift());return n.search=e.search,n.query=e.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var O=_.slice(-1)[0],A=(n.host||e.host||_.length>1)&&("."===O||".."===O)||""===O,T=0,E=_.length;E>=0;E--)"."===(O=_[E])?_.splice(E,1):".."===O?(_.splice(E,1),T++):T&&(_.splice(E,1),T--);if(!x&&!j)for(;T--;T)_.unshift("..");!x||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),A&&"/"!==_.join("/").substr(-1)&&_.push("");var P,S=""===_[0]||_[0]&&"/"===_[0].charAt(0);k&&(n.hostname=n.host=S?"":_.length?_.shift():"",(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift()));return(x=x||n.host&&_.length)&&!S&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},s.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof r&&r;i.global!==i&&i.window!==i&&i.self;var a,c=2147483647,u=36,h=1,l=26,f=38,p=700,d=72,y=128,w="-",g=/^xn--/,b=/[^\x20-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,v={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=u-h,j=Math.floor,_=String.fromCharCode;function k(e){throw new RangeError(v[e])}function O(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function A(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+O((e=e.replace(m,".")).split("."),t).join(".")}function T(e){for(var t,n,r=[],o=0,s=e.length;o<s;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<s?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function E(e){return O(e,function(e){var t="";return e>65535&&(t+=_((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=_(e)}).join("")}function P(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:u}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function M(e,t,n){var r=0;for(e=n?j(e/p):e>>1,e+=j(e/t);e>x*l>>1;r+=u)e=j(e/x);return j(r+(x+1)*e/(e+f))}function q(e){var t,n,r,o,s,i,a,f,p,g,b=[],m=e.length,v=0,x=y,_=d;for((n=e.lastIndexOf(w))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&k("not-basic"),b.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<m;){for(s=v,i=1,a=u;o>=m&&k("invalid-input"),((f=P(e.charCodeAt(o++)))>=u||f>j((c-v)/i))&&k("overflow"),v+=f*i,!(f<(p=a<=_?h:a>=_+l?l:a-_));a+=u)i>j(c/(g=u-p))&&k("overflow"),i*=g;_=M(v-s,t=b.length+1,0==s),j(v/t)>c-x&&k("overflow"),x+=j(v/t),v%=t,b.splice(v++,0,x)}return E(b)}function C(e){var t,n,r,o,s,i,a,f,p,g,b,m,v,x,O,A=[];for(m=(e=T(e)).length,t=y,n=0,s=d,i=0;i<m;++i)(b=e[i])<128&&A.push(_(b));for(r=o=A.length,o&&A.push(w);r<m;){for(a=c,i=0;i<m;++i)(b=e[i])>=t&&b<a&&(a=b);for(a-t>j((c-n)/(v=r+1))&&k("overflow"),n+=(a-t)*v,t=a,i=0;i<m;++i)if((b=e[i])<t&&++n>c&&k("overflow"),b==t){for(f=n,p=u;!(f<(g=p<=s?h:p>=s+l?l:p-s));p+=u)O=f-g,x=u-g,A.push(_(S(g+O%x,0))),f=j(O/x);A.push(_(S(f,0))),s=M(n,v,r==o),n=0,++r}++n,++t}return A.join("")}a={version:"1.4.1",ucs2:{decode:T,encode:E},decode:q,encode:C,toASCII:function(e){return A(e,function(e){return b.test(e)?"xn--"+C(e):e})},toUnicode:function(e){return A(e,function(e){return g.test(e)?q(e.slice(4).toLowerCase()):e})}},void 0===(o=function(){return a}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(72)(e),n(14))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t){e.exports=function(e,t,n,r){return new Promise(function(o,s){var i=new window.XMLHttpRequest;i.open(e,t),i.onload=function(){return o({status:i.status,body:i.responseText})},i.onerror=i.onabort=function(){return s(new Error(i.statusText||"XHR aborted: "+t))},Object.keys(r).forEach(function(e){i.setRequestHeader(e,r[e])}),i.send(n)})}},function(e){e.exports={name:"ketting",version:"2.4.1",description:"Opiniated HATEAOS / Rest client.",main:"dist/index.js",scripts:{test:"make test",prepublishOnly:"make build",build:"make build"},repository:{type:"git",url:"git+https://github.com/evert/ketting.git"},keywords:["rest","hypermedia","client","http","hateoas","hal"],author:"Evert Pot",license:"MIT",bugs:{url:"https://github.com/evert/ketting/issues"},homepage:"https://github.com/evert/ketting#readme",files:["dist/","browser/ketting.min.js","browser/ketting.min.js.map"],types:"dist/index.d.ts",dependencies:{"@types/node-fetch":"^2.1.2","client-oauth2":"^4.2.1","http-link-header":"^0.8.0","node-fetch":"^2.2.0","querystring-browser":"^1.0.4",sax:"^1.2.4","uri-template":"^1.0.1"},devDependencies:{"@types/chai":"^4.1.4","@types/http-link-header":"^0.6.2","@types/koa-bodyparser":"^5.0.1","@types/koa-logger":"^3.1.0","@types/koa-static":"^4.0.0","@types/mocha":"^5.2.5","@types/node":"^10.10.1","@types/sax":"^1.0.1","awesome-typescript-loader":"^5.2.1",chai:"^4.1.2",koa:"^2.5.3","koa-bodyparser":"^4.2.1","koa-logger":"^3.2.0","koa-path-match":"^2.0.0","koa-static":"^5.0.0",mocha:"^5.2.0",nyc:"^13.0.1","ts-node":"^7.0.1",tslint:"^5.11.0",typescript:"^3.0.3",webpack:"^4.19.1","webpack-cli":"^3.1.0"},nyc:{extension:[".ts"]}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(6));describe("Link",()=>{it("should construct and expose its properties",()=>{const e=new s.default({baseHref:"http://example.org/",href:"/foo/bar",rel:"foo",name:"foo-link",type:"text/css",templated:!1,title:"Foo Link"});o.expect(e.rel).to.equal("foo"),o.expect(e.baseHref).to.equal("http://example.org/"),o.expect(e.href).to.equal("/foo/bar"),o.expect(e.type).to.equal("text/css"),o.expect(e.templated).to.equal(!1),o.expect(e.title).to.equal("Foo Link"),o.expect(e.name).to.equal("foo-link")}),it("should be able to resolve relative links",()=>{const e=new s.default({rel:"about",baseHref:"http://example.org/",href:"/foo/bar"});o.expect(e.resolve()).to.equal("http://example.org/foo/bar")}),it("should be able to expand templated links",()=>{const e=new s.default({baseHref:"http://example.org/",href:"/foo/{bar}",rel:"about",templated:!0});o.expect(e.expand({bar:"zim"})).to.equal("http://example.org/foo/zim")}),it("should not error when expanding non-templated links",()=>{const e=new s.default({baseHref:"http://example.org/",href:"/foo/bar",rel:"about"});o.expect(e.expand({bar:"zim"})).to.equal("http://example.org/foo/bar")})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(6)),i=r(n(16));describe("HTML representor",()=>{[['<link rel="me" href="https://evertpot.com/" />',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<link rel="me" href="https://evertpot.com/">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<LINK rel="me" href="https://evertpot.com/">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<link REL="me" href="https://evertpot.com/">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<link href="https://evertpot.com/" rel="me" />',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<link href="https://evertpot.com/" rel="me" title="my website!"/>',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<link href="foo.css" rel="stylesheet" type="text/css" />',new s.default({rel:"stylesheet",baseHref:"/index.html",href:"foo.css",type:"text/css"})],['<a href="https://evertpot.com/" rel="me">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<A href="https://evertpot.com/" rel="me">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<a HREF="https://evertpot.com/" rel="me">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<a rel="me" href="https://evertpot.com/">',new s.default({rel:"me",baseHref:"/index.html",href:"https://evertpot.com/"})],['<a rel="icon favicon" href="favicon.ico">',new s.default({rel:"icon",baseHref:"/index.html",href:"favicon.ico"}),new s.default({rel:"favicon",baseHref:"/index.html",href:"favicon.ico"})],['<link href="https://evertpot.com/" />'],['<link rel="me" />']].forEach(e=>{it("should parse "+e[0],()=>{const t=new i.default("/index.html","text/html",e[0]),n=e.slice(1);o.expect(t.uri).to.equal("/index.html"),o.expect(t.contentType).to.equal("text/html"),o.expect(t.links).to.eql(n)})})})},function(e,t,n){var r={"./basic-auth.ts":79,"./bearer-auth.ts":80,"./delete.ts":81,"./fetch-api.ts":82,"./follow-hal-template.ts":83,"./follow-hal.ts":84,"./get.ts":85,"./oauth-auth.ts":86,"./patch.ts":87,"./post.ts":88,"./put.ts":89};function o(e){var t=s(e);return n(t)}function s(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id=78},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));describe("Basic Authentication",()=>{it("should return 401 if no credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json"),t=await e.follow("auth-basic"),n=await t.fetch();o.expect(n.status).to.eql(401)}),it("should return 401 if incorrect credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"basic",userName:"foo",password:"bar"}}),t=await e.follow("auth-basic"),n=await t.fetch();o.expect(n.status).to.eql(401)}),it("should return 200 OK if correct credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"basic",userName:"user",password:"pass"}}),t=await e.follow("auth-basic"),n=await t.fetch();o.expect(n.status).to.eql(200)})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));describe("Bearer Authentication",()=>{it("should return 401 if no credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json"),t=await e.follow("auth-bearer"),n=await t.fetch();o.expect(n.status).to.eql(401)}),it("should return 401 if incorrect credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"bearer",token:"bar"}}),t=await e.follow("auth-bearer"),n=await t.fetch();o.expect(n.status).to.eql(401)}),it("should return 200 OK if correct credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"bearer",token:"foo"}}),t=await e.follow("auth-bearer"),n=await t.fetch();o.expect(n.status).to.eql(200)})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=n(28),i=r(n(1));describe("Issuing a DELETE request",async()=>{const e=new i.default("http://localhost:3000/hal1.json");let t;before(async()=>{t=e.getResource(),await t.get()}),it("should not fail",async()=>{await t.delete()}),it("should have cleared the resource representation",async()=>{let e=!1;try{await t.get()}catch(t){e=!0}o.expect(e).to.eql(!0)}),it("should have cleared the global cache",async()=>{let t=!1;try{await e.getResource().get()}catch(e){t=!0}o.expect(t).to.eql(!0)}),it("should throw an exception when there was a HTTP error",async()=>{await e.getResource("/reset").post({}),e.resourceCache={};const t=await e.follow("error400");let n;try{await t.delete()}catch(e){n=e}o.expect(n.response.status).to.equal(400)}),it("should throw a Problem exception when there was a HTTP error with a application/problem+json response",async()=>{await e.getResource("/reset").post({}),e.resourceCache={};const t=await e.follow("problem");let n;try{await t.delete()}catch(e){n=e}o.expect(n.status).to.equal(410),o.expect(n).to.be.an.instanceof(s.Problem),o.expect(n.message).to.equal("HTTP Error 410: Some sort of error!")}),after(async()=>{await e.getResource("/reset").post({})})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));n(12),describe("Using the fetch api",()=>{let e,t;before(async()=>{t=new s.default("http://localhost:3000/hal1.json"),e=await t.follow("next")}),it("should return a response object",async()=>{const t=await e.fetch("?foo=bar");o.expect(t).to.have.property("status"),o.expect(t.status).to.eql(200)}),it("should also work when passing a Request object",async()=>{const t=new Request("?foo=bar"),n=await e.fetch(t);o.expect(n).to.have.property("status"),o.expect(n.status).to.eql(200)}),it("should allow overriding the HTTP method",async()=>{const t=await e.fetch({method:"PUT"});o.expect(t).to.have.property("status"),o.expect(t.status).to.eql(204)}),it("should allow overriding the url",async()=>{const t=await e.fetch("?foo=bar",{method:"PUT",headers:{"X-Foo":"Bar"}});o.expect(t).to.have.property("status"),o.expect(t.status).to.eql(204)}),it("should allow overriding the Content-Type header",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{fetchInit:{headers:{"Content-Type":"application/json"}}}),t=await e.follow("headerTest"),n=await t.fetch({method:"POST",headers:{"Content-Type":"image/png"}}),r=await n.json();o.expect(r["content-type"]).to.eql("image/png")}),it("should allow overriding the User-Agent  header",async()=>{const e=await t.follow("headerTest"),n=await e.fetch({method:"POST",headers:{"User-Agent":"foo-bar/1.2"}}),r=await n.json();o.expect(r["user-agent"]).to.eql("foo-bar/1.2")}),it("Calling fetch on the client itself should also work",async()=>{const e=await t.fetch("http://localhost:3000/hal1.json",{method:"PUT",headers:{"X-Foo":"Bar"}});o.expect(e).to.have.property("status"),o.expect(e.status).to.eql(204)}),it("should throw a TypeError when passing an incorrect value for input",async()=>{let t;try{e.fetch(42)}catch(e){t=e}o.expect(t).to.be.instanceof(TypeError)}),after(async()=>{await t.getResource("/reset").post({})})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1)),i=r(n(11));describe("Following a templated link",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t;it("should have expanded the uri",async()=>{t=await e.follow("templated",{foo:"bar"}),o.expect(t).to.be.an.instanceof(i.default),o.expect(t.uri).to.eql("http://localhost:3000/templated.json?foo=bar")}),it("should have expanded the uri after several follows",async()=>{t=await e.follow("next").follow("prev").follow("templated",{foo:"bar"}),o.expect(t).to.be.an.instanceof(i.default),o.expect(t.uri).to.eql("http://localhost:3000/templated.json?foo=bar")})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1)),i=r(n(11));describe("Following a link",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t;it("should return a resource",async()=>{t=await e.follow("next"),o.expect(t).to.be.an.instanceof(i.default)}),it('should remember the type="" property for later usage',async()=>{const t=await e.follow("content-type-link");o.expect(t).to.be.an.instanceof(i.default),o.expect(t.contentType).to.eql("application/foo+json")}),it("should get the correct response to GET",async()=>{const e=await t.get();o.expect(e).to.eql({title:"HAL 2!"})}),it("should be chainable",async()=>{const t=await e.follow("next").follow("prev"),n=await t.get();o.expect(n).to.eql({title:"Hal 1",foo:"bar"})}),it("should throw an error following non-existent relationships",async()=>{let t;try{const n=await e.follow("next").follow("unknown");await n.get()}catch(e){t=e}o.expect(t).to.be.instanceof(Error)}),it("should be chainable several times",async()=>{const t=await e.follow("next").follow("prev").follow("next").follow("prev"),n=await t.get();o.expect(n).to.eql({title:"Hal 1",foo:"bar"})}),describe("followAll",()=>{it("should work with embedded resources",async()=>{const t=await e.follow("collection").followAll("item");o.expect(t).to.have.length(2),o.expect(t[0]).to.be.an.instanceof(i.default),o.expect(t[1]).to.be.an.instanceof(i.default)}),it('should remember the type="" property for later usage',async()=>{const t=await e.follow("self").followAll("content-type-link");o.expect(t[0]).to.be.an.instanceof(i.default),o.expect(t[0].contentType).to.eql("application/foo+json")})})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1)),i=r(n(6));describe("Issuing a GET request",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t,n;before(async()=>{t=await e.follow("headerTest")}),it("should not fail",async()=>{n=await t.get()}),it("should have sent the correct headers",async()=>{o.expect(n).to.have.property("user-agent"),o.expect(n["user-agent"]).to.match(/^Ketting\//),o.expect(n.accept).to.eql("application/hal+json;q=1.0, application/json;q=0.9, text/html;q=0.8")}),it("should throw an exception when there was a HTTP error",async()=>{const t=await e.follow("error400");let n;try{await t.get()}catch(e){n=e}o.expect(n.response.status).to.equal(400)}),it("should support the HTTP Link header",async()=>{const t=await e.follow("linkHeader"),n=await t.links(),r=[new i.default({rel:"next",baseHref:"http://localhost:3000/link-header",href:"/hal2.json"}),new i.default({rel:"previous",baseHref:"http://localhost:3000/link-header",href:"/TheBook/chapter2"}),new i.default({rel:"start",baseHref:"http://localhost:3000/link-header",href:"http://example.org/"}),new i.default({rel:"http://example.net/relation/other",baseHref:"http://localhost:3000/link-header",href:"http://example.org/"})];o.expect(n).to.eql(r)}),it("should throw an exception when no content-type was returned",async()=>{const t=await e.follow("no-content-type");let n=!1;try{await t.get()}catch(e){n=!0}o.expect(n).to.eql(!0)})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));describe("OAuth2 Authentication",()=>{describe("Owner flow",()=>{it("should return 401 if no credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json"),t=await e.follow("auth-oauth"),n=await t.fetch();o.expect(n.status).to.eql(401)}),it("should throw error if incorrect client credentials were passed.",e=>{new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClient",clientSecret:"fooSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]},owner:{userName:"fooOwner",password:"barPassword"}}}).follow("auth-oauth").catch(t=>{o.expect(t).to.be.an("error"),e()})}),it("should return 401 if incorrect owner credentials were passed.",e=>{new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClient",clientSecret:"barSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]},owner:{userName:"fooOwner",password:"fooPassword"}}}).follow("auth-oauth").catch(t=>{o.expect(t).to.be.an("error"),e()})}),it("should return 200 OK if correct credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClient",clientSecret:"barSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]},owner:{userName:"fooOwner",password:"barPassword"}}}),t=await e.follow("auth-oauth"),n=await t.fetch();o.expect(n.status).to.eql(200)}),it("should refresh token if 401 is returned and retry request",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClient",clientSecret:"barSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]},owner:{userName:"fooOwner",password:"barPassword"}}}),t=e.oauth2Helper.client.createToken("barToken","fooRefresh","bearer");e.oauth2Helper.token=t;const n=await e.follow("auth-oauth"),r=await n.fetch();o.expect(r.status).to.eql(200)}),it("should refresh token if 401 is returned and throw error if refresh is invalid",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClient",clientSecret:"barSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]},owner:{userName:"fooOwner",password:"barPassword"}}}),t=e.oauth2Helper.client.createToken("barToken","barRefresh","bearer");e.oauth2Helper.token=t;try{const t=await e.follow("auth-oauth");await t.fetch()}catch(e){o.expect(e).to.be.an("error")}})}),describe("Client credentials flow",()=>{it("should throw error if incorrect client credentials were passed.",e=>{new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"badlient",clientSecret:"badSecret",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]}}}).follow("auth-oauth").catch(t=>{o.expect(t).to.be.an("error"),e()})}),it("should return 200 OK if correct credentials were passed.",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClientCredentials",clientSecret:"barSecretCredentials",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]}}}),t=await e.follow("auth-oauth"),n=await t.fetch();o.expect(n.status).to.eql(200)}),it("should refresh token if 401 is returned and retry request",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClientCredentials",clientSecret:"barSecretCredentials",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]}}}),t=e.oauth2Helper.client.createToken("barToken","fooRefresh","bearer");e.oauth2Helper.token=t;const n=await e.follow("auth-oauth"),r=await n.fetch();o.expect(r.status).to.eql(200)}),it("should refresh token if 401 is returned and throw error if refresh is invalid",async()=>{const e=new s.default("http://localhost:3000/hal1.json",{auth:{type:"oauth2",client:{clientId:"fooClientCredentials",clientSecret:"barSecretCredentials",accessTokenUri:"http://localhost:3000/oauth-token",scopes:["test"]}}}),t=e.oauth2Helper.client.createToken("barToken","barRefresh","bearer");e.oauth2Helper.token=t;try{const t=await e.follow("auth-oauth");await t.fetch()}catch(e){o.expect(e).to.be.an("error")}})})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));describe("Issuing a PATCH request",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t;before(async()=>{t=await e.getResource().follow("echo"),await t.get()}),it("should not fail",async()=>{await t.patch({newData:"hi!"})}),it("should have cleared the resource representation",async()=>{o.expect(t.repr).to.eql(null)}),it("should throw an exception if there was an http error",async()=>{let t=!1;try{const n=await e.follow("error400");await n.patch({foo:"bar"})}catch(e){t=!0}o.expect(t).to.eql(!0)}),after(async()=>{await e.getResource("/reset").post({})})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1)),i=r(n(11));describe("Issuing a POST request",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t,n;before(async()=>{t=e.getResource()}),it("should not fail",async()=>{n=await t.post({title:"Posted resource"})}),it("should have returned a new resource",async()=>{o.expect(n).to.be.an.instanceof(i.default),o.expect(n.uri).to.match(/\.json$/)}),it("should have created the new resource",async()=>{const e=await n.get();o.expect(e).to.eql({title:"Posted resource"})}),it("should throw an exception when there was a HTTP error",async()=>{const t=await e.follow("error400");let n;try{await t.post({foo:"bar"})}catch(e){n=e}o.expect(n.response.status).to.equal(400)})})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=r(n(1));describe("Issuing a PUT request",async()=>{const e=new s.default("http://localhost:3000/hal1.json");let t;before(async()=>{t=await e.getResource().follow("next"),await t.get()}),it("should not fail",async()=>{await t.put({newData:"hi!"})}),it("should have cleared the resource representation",async()=>{const e=await t.get();o.expect(e).to.eql({newData:"hi!"})}),it("should have cleared the global cache",async()=>{const t=await(await e.follow("next")).get();o.expect(t).to.eql({newData:"hi!"})}),it("should throw an exception if there was an http error",async()=>{let t=!1;try{const n=await e.follow("error400");await n.put({foo:"bar"})}catch(e){t=!0}o.expect(t).to.eql(!0)}),after(async()=>{await e.getResource("/reset").post({})})})}]);